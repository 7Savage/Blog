/**
 * 作者：陈霓清
 * 官网：http://www.javaex.cn
 */
;(function(){var javaex=function(){function defaults(args){var defaults={id:"",type:"",url:"",isInit:false,name:"",uncheckClass:"",checkedClass:"",second:45,text:"获取验证码",color:"unset",backgroundColor:"transparent",downColor:"unset",downBackgroundColor:"transparent",data:[],checkbox:true,isShowAllSelect:false,isAllowJumpUrl:false,icon:false,withoutNodeArr:null,percent:0,isShowPercent:false,tags:"",mask:true,width:300,maxHeight:"",height:"",top:"30%",title:"温馨提示",closeIcon:true,content:"",textAlign:"left",confirmName:"确定",cancelName:"取消",callback:function(){return true},live:2000,timeout:0,timeoutText:"连接超时，请重试",selector:"",scrolling:"yes",offsetLeft:"0",hasBackground:false,isClickMaskClose:false,closeX:function(){return true},isAutoSelected:false,key:"key",isShowFirst:false,isShowAll:false,num:10,size:24,scoreArr:[1,2,3,4,5,6,7,8,9,10],levelTextArr:['1分','2分','3分','4分','5分','6分','7分','8分','9分','10分'],score:"",isReadOnly:false,current:1,mode:"mouseover",delay:200,display:"block",mergeColArr:[],tree:0,isClose:false,dataArr:[],maxNum:6,isSearch:false,hasInputName:false,pageCount:null,currentPage:1,perPageCount:null,totalNum:null,position:"right",isShowJumpPage:false,isAutoPlay:true,focusCenter:false,startSlide:1,focusBoxMode:"mouseover",effect:null,date:"",startDate:"",endDate:"",alignment:"left",monthNum:1,splitLine:" - ",minTime:"",maxTime:"",time:"",imgDivId:"image-box",cutBox:"cut-box",moveBox:"move-box",dataUrl:"data-url",threshold:100,event:"scroll",container:window,dataOriginal:"data-original",appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",isShowOptTip:false,containerId:"",uploadText:"上传封面",param:"file",maxSize:"",imgUrl:"",dataType:"base64",addImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAIBJREFUSA3tl7ENwCAMBN9RpkvFQsyUNGE9IpIs8P8FBUZy58PmkLAAxFXqdY8QcewqCPRDZ4HNgR02Czv2KDZVU7qc5FTt2KPY9VTHN2G8B59y/CZHm6I6Ap1v9idKPfsIdYMpJx7NZmH1ymguVdPKVCBVq+Zobj3Vxt8pmjNlHkcEEcpxsEklAAAAAElFTkSuQmCC",commentCount:0,list:null,commentMapping:null,replyMapping:null,avatar:"",isChangeTimeText:false,fixedTop:-1,image:null};return $.extend(defaults,args)}var info={getUUID:function(){return Date.now().toString(36)+Math.random().toString(36).substr(3,3)},fakeRadio:function(args){var settings=defaults(args);var name=settings.name;var uncheckClass=settings.uncheckClass;var checkedClass=settings.checkedClass;$(':radio[name="'+name+'"]').each(function(){if($(this).is(":checked")){$(this).closest("label").addClass(checkedClass);if(settings.isInit){settings.callback({"val":$(this).val()})}}else{$(this).closest("label").addClass(uncheckClass)}});$(':radio[name="'+name+'"]').change(function(){$(':radio[name="'+name+'"]').each(function(){$(this).closest("label").removeClass(checkedClass).addClass(uncheckClass)});$(this).closest("label").removeClass(uncheckClass).addClass(checkedClass);settings.callback({"val":$(this).val()})})},fakeCheckbox:function(args){var settings=defaults(args);var name=settings.name;var uncheckClass=settings.uncheckClass;var checkedClass=settings.checkedClass;$(':checkbox[name="'+name+'"]').each(function(){if($(this).is(":checked")){$(this).parent("label").addClass(checkedClass);if(settings.isInit){settings.callback({"val":$(this).val()})}}else{$(this).parent("label").addClass(uncheckClass)}});$(':checkbox[name="'+name+'"]').change(function(){if($(this).is(":checked")){$(this).closest("label").removeClass(uncheckClass).addClass(checkedClass)}else{$(this).closest("label").removeClass(checkedClass).addClass(uncheckClass)}})},timerId:null,code:function(args){var settings=defaults(args);var id=settings.id;var second=parseInt(settings.second);if(settings.type=="reset"){clearInterval(info.timerId);$("#"+id).css({"pointer-events":"unset","color":settings.color,"background-color":settings.backgroundColor});$("#"+id).text(settings.text);second=parseInt(settings.second)}else{setTimer();function setTimer(){$("#"+id).css({"pointer-events":"none","color":settings.downColor,"background-color":settings.downBackgroundColor});info.timerId=setInterval(function(){second=second-1;if(second>0){$("#"+id).text(second+"秒后重试")}else{clearInterval(info.timerId);$("#"+id).css({"pointer-events":"unset","color":settings.color,"background-color":settings.backgroundColor});$("#"+id).text(settings.text);second=parseInt(settings.second)}},1000)}}},tree:function(args){var settings=defaults(args);var id=settings.id;var jsonData=settings.data;var checkbox=settings.checkbox;var icon=settings.icon;var withoutNodeArr=settings.withoutNodeArr;var flag=false;function tree(jsonData,nodeIndex){if(jsonData.length>0){if(!nodeIndex){nodeIndex=1}html+='<ul style="overflow: hidden;">';$.each(jsonData,function(i,data){if(!!data.childrenList&&data.childrenList.length>0){if(data.open){html+='<li class="tree-parent-li" open="true">'}else{html+='<li class="tree-parent-li">'}html+='<span class="tree-icon icon-caret-right"></span>';if(checkbox){if(data.checked){html+='<input type="checkbox" class="fill listen-'+id+'1-2" node="'+nodeIndex+'" name="javaex-tree" value="'+data.id+'" checked/> '}else{html+='<input type="checkbox" class="fill listen-'+id+'1-2" node="'+nodeIndex+'" name="javaex-tree" value="'+data.id+'" /> '}}html+='<a href="javascript:;" node="'+nodeIndex+'" menu-id="'+data.id+'">';if(icon){if(!!data.icon){flag=true;html+='<span class="tree-icon '+data.icon+'"></span>'}else{html+='<span class="tree-icon icon-folder"></span>'}}html+=data.name+'</a>';tree(data.childrenList,(nodeIndex+1))}else{html+='<li class="tree-child-li">';if(checkbox){if(data.checked){html+='<input type="checkbox" class="fill listen-'+id+'1-2" node="'+nodeIndex+'" name="javaex-tree" value="'+data.id+'" checked/> '}else{html+='<input type="checkbox" class="fill listen-'+id+'1-2" node="'+nodeIndex+'" name="javaex-tree" value="'+data.id+'" /> '}}if(!data.url||settings.isAllowJumpUrl==false){html+='<a href="javascript:;" node="'+nodeIndex+'" menu-id="'+data.id+'">'}else{html+='<a href="'+data.url+'" node="'+nodeIndex+'" menu-id="'+data.id+'">'}if(icon){if(!!data.icon){flag=true;html+='<span class="tree-icon '+data.icon+'"></span>'}else{html+='<span class="tree-icon icon-folder"></span>'}}html+=data.name+'</a>';html+='</li>'}});html+='</ul>'}}function tree2(jsonData){if(jsonData.length>0){var jsonArr=new Array();$.each(jsonData,function(i,data){if(parseInt(data.parentId)<1){var childrenList=addChild(jsonData,data.id);data.childrenList=childrenList;jsonArr.push(data)}});tree(jsonArr)}}function addChild(jsonData,parentId){var childArr=new Array();for(var i=0;i<jsonData.length;i++){if(jsonData[i].parentId==parentId){var childrenList=addChild(jsonData,jsonData[i].id);jsonData[i].childrenList=childrenList;childArr.push(jsonData[i])}}return childArr}var html='';if(settings.isShowAllSelect){html+='<input type="checkbox" name="javaex-all-select" class="fill listen-'+id+'1" /> 全选'}if(parseInt(settings.type)==1){tree(jsonData)}else{tree2(jsonData)}$("#"+id).empty();$("#"+id).append(html);if(checkbox){if(settings.isShowAllSelect){$("script").each(function(){if(!!$(this).attr("src")){if($(this).attr("src").indexOf("common.js")>-1){var jsSrc=$(this).attr("src");var script=document.createElement("script");script.src=jsSrc;$(document.body).append(script)}}});$('#'+id+' input[name="javaex-all-select"]').parent().find(".fill-text").css({"vertical-align":"text-bottom"});$('#'+id+' :checkbox[name="javaex-all-select"]').click(function(){changeCheckBoxStatus($(this))});callback()}else{$("#"+id+" :checkbox").each(function(){if($(this).hasClass("fill")){var text=$(this)[0].nextSibling.nodeValue;$(this)[0].nextSibling.nodeValue="";$(this).wrap('<label class="fill-label"></label>');if(!!text){text=text.replace(/(\s*$)/g,"");$(this).parent().append('<span>'+text+'</span>')}if($(this).siblings().length==1){$(this).after('<span class="fill-css icon-check" style="color: #fff;"></span>')}}})}$('#'+id+' :checkbox[name="javaex-tree"]:checked').each(function(){if($(this).parent().parent("li").attr("class")=="tree-child-li"){changeCheckBoxStatus($(this))}});$('#'+id+' :checkbox[name="javaex-tree"]').click(function(){changeCheckBoxStatus($(this))})}function changeCheckBoxStatus(obj){if(!obj.attr("class")){return}var parentLi=obj.parent().parent();if(parentLi.hasClass("tree-parent-li")){var sibLen=parentLi.siblings().length+1;var checkedNum=0;obj.siblings("span.icon-stop").removeClass("icon-stop").addClass("icon-check");if(obj.is(":checked")){checkedNum++;parentLi.find("label").find("span.icon-stop").removeClass("icon-stop").addClass("icon-check");parentLi.find(":checkbox").attr("checked",true);obj.parent().parent("li").addClass("checked")}else{parentLi.find(":checkbox").attr("checked",false);obj.parent().parent("li").removeClass("checked")}parentLi.siblings("li").children("label").find(":checkbox").each(function(){if($(this).is(":checked")&&$(this).siblings("span.icon-check").length>0){checkedNum++}});var objLi=parentLi.parent().parent("li.tree-parent-li");if(objLi.length>0){if(checkedNum==sibLen){objLi.children("label").find("span.icon-stop").removeClass("icon-stop").addClass("icon-check");objLi.children("label").find(":checkbox").attr("checked",true);objLi.addClass("checked")}else if(checkedNum==0){objLi.children("label").find(":checkbox").attr("checked",false);objLi.removeClass("checked")}else{objLi.children("label").find("span.icon-check").removeClass("icon-check").addClass("icon-stop");objLi.children("label").find(":checkbox").attr("checked",true);objLi.removeClass("checked")}changeParentCheckBoxStatus(objLi)}}else{var sibLen=parentLi.siblings().length+1;var checkedNum=0;if(obj.is(":checked")){checkedNum++;obj.parent().parent("li").addClass("checked")}else{obj.parent().parent("li").removeClass("checked")}parentLi.siblings("li").children("label").find(":checkbox").each(function(){if($(this).is(":checked")&&$(this).siblings("span.icon-check").length>0){checkedNum++}});var objLi=parentLi.parent().parent("li.tree-parent-li");if(objLi.length>0){if(checkedNum==sibLen){objLi.children("label").find("span.icon-stop").removeClass("icon-stop").addClass("icon-check");objLi.children("label").find(":checkbox").attr("checked",true);objLi.addClass("checked")}else if(checkedNum==0){objLi.children("label").find(":checkbox").attr("checked",false);objLi.removeClass("checked")}else{objLi.children("label").find("span.icon-check").removeClass("icon-check").addClass("icon-stop");objLi.children("label").find(":checkbox").attr("checked",true);objLi.removeClass("checked")}changeParentCheckBoxStatus(objLi)}}callback()}function changeParentCheckBoxStatus(obj){var flag=false;var sibLen=obj.siblings().length+1;var checkedNum=0;var thisCheckBox=obj.children("label").find(":checkbox");if(thisCheckBox.is(":checked")){checkedNum++;if(thisCheckBox.siblings("span.icon-check").length==0){flag=true}}else{obj.find(":checkbox").attr("checked",false)}obj.siblings("li").children("label").find(":checkbox").each(function(){if($(this).is(":checked")){checkedNum++;if($(this).siblings("span.icon-check").length==0){flag=true}}});var objLi=obj.parent().parent("li.tree-parent-li");if(objLi.length>0){if(checkedNum==sibLen){if(flag){objLi.children("label").find("span.icon-check").removeClass("icon-check").addClass("icon-stop");objLi.children("label").find(":checkbox").attr("checked",true)}else{objLi.children("label").find("span.icon-stop").removeClass("icon-stop").addClass("icon-check");objLi.children("label").find(":checkbox").attr("checked",true)}}else if(checkedNum==0){objLi.children("label").find(":checkbox").attr("checked",false);objLi.removeClass("checked")}else{objLi.children("label").find("span.icon-check").removeClass("icon-check").addClass("icon-stop");objLi.children("label").find(":checkbox").attr("checked",true)}changeParentCheckBoxStatus(objLi)}}function callback(){var idArr=new Array();$('#'+id+' :checkbox[name="javaex-tree"]:checked').each(function(){if(withoutNodeArr==null||$.inArray(parseInt($(this).attr("node")),withoutNodeArr)==-1){idArr.push($(this).val())}});settings.callback({"idArr":idArr})}if(settings.isClose){$("#"+id+" li.tree-parent-li").find(">ul>li").hide()}else{$("#"+id+" .tree-icon").addClass("icon-caret-down").removeClass("icon-caret-right")}if(icon&&!flag){$("#"+id+" li").each(function(){if($(this).hasClass("tree-child-li")){$(this).find(">a>span").addClass("icon-document-alt-fill").removeClass("icon-folder")}})}$("#"+id+" li.tree-parent-li").each(function(){if($(this).attr("open")){$(this).children("span").addClass("icon-caret-down").removeClass("icon-caret-right");if(icon&&!flag){$(this).children("a").children("span").addClass("icon-folder-open").removeClass("icon-folder")}$(this).children("ul").find(">li").show()}});$("#"+id+" li a").on("click",function(e){$("#"+id+" li a").removeClass("on");$(this).addClass("on");settings.callback({"node":$(this).attr("node"),"id":$(this).attr("menu-id"),"name":$(this).text()})});$("#"+id+" li.tree-parent-li>span").on("click",function(e){var children=$(this).siblings("ul").find(">li");if(children.is(":hidden")){$(this).addClass("icon-caret-down").removeClass("icon-caret-right");if(icon&&!flag){$(this).siblings("a").children("span").addClass("icon-folder-open").removeClass("icon-folder")}children.show("fast")}else{$(this).addClass("icon-caret-right").removeClass("icon-caret-down");if(icon&&!flag){$(this).siblings("a").children("span").addClass("icon-folder").removeClass("icon-folder-open")}children.hide("fast")}e.stopPropagation()})},progress:function(args){var settings=defaults(args);var percent=parseInt(settings.percent);var selector=settings.selector;if(settings.isShowPercent){$(selector).html("<span>"+percent+"%</span>")}else{$(selector).html(" ")}if($(selector).width()<1){$(selector).css({"width":percent+"%","transition":"width 0.8s 0.1s"})}else{$(selector).css({"width":percent+"%"})}},lazyload:function(args){var settings=defaults(args);var selector=settings.selector;var elements=$(selector);var effect=settings.effect;if(!effect){effect="fadeIn"}$(document).ready(function(){$(settings.container).trigger(settings.event);checkImage()});$(window).bind("resize",function(){checkImage()});$container=(settings.container===undefined||settings.container===window)?$(window):$(settings.container);if(0===settings.event.indexOf("scroll")){$container.bind(settings.event,function(){return checkImage()})}elements.each(function(){var self=this;var $self=$(self);self.loaded=false;if(!$self.attr("src")){if($self.is("img")){$self.attr("src",settings.placeholder)}}$self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings)}$("<img />").bind("load",function(){var original=$self.attr(settings.dataOriginal);$self.hide();if($self.is("img")){$self.attr("src",original)}else{$self.css("background-image","url('"+original+"')")}$self[effect](400);self.loaded=true;$self.removeAttr(settings.dataOriginal);var temp=$.grep(elements,function(element){return!element.loaded});elements=$(temp);if(settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings)}}).attr("src",$self.attr(settings.dataOriginal))}})});function checkImage(){var counter=0;elements.each(function(){var $this=$(this);if(!$this.is(":visible")){return}if($.abovethetop(this,settings)||$.leftofbegin(this,settings)){}else if(!$.belowthefold(this,settings)&&!$.rightoffold(this,settings)){$this.trigger("appear");counter=0}else{if(++counter>0){return false}}})}},getTime:function(param){var date=new Date();var year=date.getFullYear();var month=date.getMonth()+1;var day=date.getDate();if(!param){return year+"-"+add0(month)+"-"+add0(day)+" "+add0(date.getHours())+":"+add0(date.getMinutes())+":"+add0(date.getSeconds())}else{param=param.toLowerCase();if(param=="year"){return year}if(param=="month"){return month}if(param=="day"){return day}if(param=="today"){return year+"-"+add0(month)+"-"+add0(day)}if(param=="week"){var week=date.getDay();if(week==0){week=7}return week}}function add0(num){if(num>=1&&num<=9){num="0"+num}return num}},getTimeDiff:function(startTime,endTime,type){startTime=startTime.replace(/\-/g,"/");endTime=endTime.replace(/\-/g,"/");type=type.toLowerCase();var sTime=new Date(startTime);var eTime=new Date(endTime);var divNum=1;switch(type){case"second":divNum=1000;break;case"minute":divNum=1000*60;break;case"hour":divNum=1000*3600;break;case"day":divNum=1000*3600*24;break;default:break}return parseInt((eTime.getTime()-sTime.getTime())/parseInt(divNum))},comment:function(args){var settings=defaults(args);var id=settings.id;var list=settings.list;var url=settings.url;var commentMapping=settings.commentMapping;var replyMapping=settings.replyMapping;attribute=args;var html='';html+='<div class="comment-form"><div class="form-textwrap"><textarea wrap="virtual" class="comment-textarea original" placeholder="我来说两句..."></textarea></div>';html+='<div style="text-align:right;">';html+='<button class="button comment-submit" onclick="javaex.javaexComment(this, attribute)">发表评论</button>';html+='</div></div>';html+='<div style="height:40px;line-height: 40px;">';html+='<div class="comment-count-title">全部评论<span style="font-size: 16px;color: #999;">('+settings.commentCount+')</span></div>';html+='</div>';html+='<ul class="comment-ul">';for(var i=0;i<list.length;i++){html+='<li id="'+list[i][commentMapping.commentId]+'">';html+='<div class="comment-left">';html+='<div class="avatar60">';if(!list[i][commentMapping.avatar]){html+='<a href="'+url+list[i][commentMapping.userId]+'" target="_blank" style="display: block;"><img src="'+settings.avatar+'" class="face" /></a>'}else{html+='<a href="'+url+list[i][commentMapping.userId]+'" target="_blank" style="display: block;"><img src="'+list[i][commentMapping.avatar]+'" class="face" /></a>'}html+='</div>';html+='</div>';html+='<div class="comment-right">';html+='<div class="comment-title"><a class="comment-author" href="'+url+list[i][commentMapping.userId]+'" target="_blank">'+list[i][commentMapping.userName]+'</a><span class="comment-time change-time">'+list[i][commentMapping.time]+'</span><input type="hidden" value="'+list[i][commentMapping.userId]+'" /></div>';html+='<div class="comment-conent">'+list[i][commentMapping.content]+'</div>';html+='<div class="comment-bottom">';var replyList=list[i][commentMapping.replyList];if(replyList.length==0){html+='<a href="javascript:;" class="right" onclick="javaex.javaexShowReplyTextarea1(this, attribute)">回复</a>'}html+='</div>';if(replyList.length>0){html+='<div class="posrs">';html+='<ul class="clear">';var replyLen=replyList.length;for(var j=0;j<replyLen;j++){html+='<li>';html+='<div class="comment-c-item">';html+='<div class="comment-left">';html+='<div class="avatar30">';if(!replyList[j][replyMapping.avatar]){html+='<a href="'+url+replyList[j][replyMapping.userId]+'" target="_blank" style="display: block;"><img src="'+settings.avatar+'" class="face" /></a>'}else{html+='<a href="'+url+replyList[j][replyMapping.userId]+'" target="_blank" style="display: block;"><img src="'+replyList[j][replyMapping.avatar]+'" class="face" /></a>'}html+='</div>';html+='</div>';html+='<div class="comment-right l40">';html+='<div class="comment-c-conent"><a class="comment-c-replyer" href="'+url+replyList[j][replyMapping.userId]+'" target="_blank">'+replyList[j][replyMapping.userName]+'</a><input type="hidden" value="'+replyList[j][replyMapping.userId]+'" />';if(!!replyList[j][replyMapping.toUserId]){html+='<span class="comment-c-reply">回复</span>';html+='<a class="comment-c-replyer2" href="'+url+replyList[j][replyMapping.toUserId]+'" target="_blank">'+replyList[j][replyMapping.toUserName]+'</a>'}html+='<span class="comment-c-text">：                    '+replyList[j][replyMapping.content]+'</span>';html+='</div>';html+='<div class="comment-replyer-time">';html+='<span class="change-time">'+replyList[j][replyMapping.time]+'</span>';html+='<a href="javascript:;" onclick="javaex.javaexShowReplyTextarea3(this, attribute)" style="position:absolute; right:0;">回复</a>';html+='</div>';html+='</div>';html+='</div>';html+='</li>'}html+='</ul>';html+='<div class="submit-part clear">';html+='<a class="say-btn right" href="javascript:;" onclick="javaex.javaexShowReplyTextarea2(this, attribute)">我也说一句</a>';html+='</div>'}html+='</div>';html+='</div>';html+='</li>'}html+='</ul>';$("#"+id).empty();$("#"+id).append(html);if(settings.isChangeTimeText){info.changeTimeTexts(".change-time")}},javaexComment:function(obj,args){var settings=defaults(args);var content=$(obj).parent().parent().find("textarea").val().replace(/<(script)[\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"");content=content.replace(/(^\s*)|(\s*$)/g,"").replace(/\'/g,"\\'");if(content==""){info.message({content:"评论内容不能为空",type:"error"});return}settings.callback({"type":"comment","content":content})},javaexShowReplyTextarea1:function(obj,args){attribute=args;var posrLength=$(obj).parent().parent().find(".posr").length;if(posrLength==0){var html='';html+='<div class="posr">';html+='<textarea wrap="virtual" class="comment-textarea comment-textarea-reply" placeholder="我来说两句..."></textarea>';html+='<div style="text-align:right;">';html+='<button class="button comment-submit" onclick="javaex.javaexReply1(this, attribute)">回复</button>';html+='</div>';html+='</div>';$(obj).parent().after(html)}else{$(obj).parent().parent().find(".posr").remove()}},javaexReply1:function(obj,args){var settings=defaults(args);var commentId=$(obj).parents("li").attr("id");var toUserId=$(obj).parent().parent().parent().children("div:first-child").children('input[type="hidden"]').val();var toUserName=$(obj).parent().parent().parent().children("div:first-child").children('a.comment-author').text().replace(/(^\s*)|(\s*$)/g,"");var content=$(obj).parent().parent().find("textarea").val().replace(/<(script)[\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"");content=content.replace(/(^\s*)|(\s*$)/g,"").replace(/\'/g,"\\'");if(content==""){info.message({content:"评论内容不能为空",type:"error"});return}settings.callback({"type":"reply","commentId":commentId,"toUserId":toUserId,"toUserName":toUserName,"content":content})},javaexShowReplyTextarea2:function(obj,args){attribute=args;var posrLength=$(obj).parent().parent().find(".posr").length;if(posrLength==0){var html='';html+='<div class="posr">';html+='<textarea wrap="virtual" class="comment-textarea comment-textarea-reply" placeholder="我来说两句..."></textarea>';html+='<div style="text-align:right;">';html+='<button class="button comment-submit" onclick="javaex.javaexReply2(this, attribute)">回复</button>';html+='</div>';html+='</div>';$(obj).parent().after(html)}else{$(obj).parent().parent().find(".posr").remove()}},javaexReply2:function(obj,args){var settings=defaults(args);var commentId=$(obj).parents("li").attr("id");var toUserId=$(obj).parent().parent().parent().parent().children("div:first-child").children('input[type="hidden"]').val();var toUserName=$(obj).parent().parent().parent().parent().children("div:first-child").children('a.comment-author').text().replace(/(^\s*)|(\s*$)/g,"");var content=$(obj).parent().parent().find("textarea").val().replace(/<(script)[\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"");content=content.replace(/(^\s*)|(\s*$)/g,"").replace(/\'/g,"\\'");if(content==""){info.message({content:"评论内容不能为空",type:"error"});return}settings.callback({"type":"reply","commentId":commentId,"toUserId":toUserId,"toUserName":toUserName,"content":content})},javaexShowReplyTextarea3:function(obj,args){attribute=args;var posrLength=$(obj).parent().parent().find(".posr").length;if(posrLength==0){var html='';html+='<div class="posr">';html+='<textarea wrap="virtual" class="comment-textarea comment-textarea-reply" placeholder="我来说两句..."></textarea>';html+='<div style="text-align:right;">';html+='<button class="button comment-submit" onclick="javaex.javaexReply3(this, attribute)">回复</button>';html+='</div>';html+='</div>';$(obj).parent().after(html)}else{$(obj).parent().parent().find(".posr").remove()}},javaexReply3:function(obj,args){var settings=defaults(args);var commentId=$(obj).parents("li").parents("li").attr("id");var toUserId=$(obj).parent().parent().parent().children("div:first-child").children('input[type="hidden"]').val();var toUserName=$(obj).parent().parent().parent().children("div:first-child").children('a.comment-c-replyer').text().replace(/(^\s*)|(\s*$)/g,"");var content=$(obj).parent().parent().find("textarea").val().replace(/<(script)[\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"");content=content.replace(/(^\s*)|(\s*$)/g,"").replace(/\'/g,"\\'");if(content==""){info.message({content:"评论内容不能为空",type:"error"});return}settings.callback({"type":"reply","commentId":commentId,"toUserId":toUserId,"toUserName":toUserName,"content":content})},changeTimeText:function(time){var timeText=time;var now=info.getTime();var day=info.getTimeDiff(time,now,"day");if(day>6){}else if(day>0){if(day==1){timeText="昨天 "+time.split(" ")[1]}else if(day==2){timeText="前天 "+time.split(" ")[1]}else{timeText=day+" 天前"}}else if(day==0){var hour=info.getTimeDiff(time,now,"hour");if(hour>0){timeText=hour+" 小时前"}else if(hour==0){var minute=info.getTimeDiff(time,now,"minute");if(minute>0){timeText=minute+" 分钟前"}else if(minute==0){var second=info.getTimeDiff(time,now,"second");timeText=second+" 秒前"}}}return timeText},changeTimeTexts:function(selector){var now=info.getTime();$(selector).each(function(){var day=info.getTimeDiff($(this).text(),now,"day");if(day>6){}else if(day>0){if(day==1){$(this).text("昨天 "+$(this).text().split(" ")[1])}else if(day==2){$(this).text("前天 "+$(this).text().split(" ")[1])}else{$(this).text(day+" 天前")}}else if(day==0){var hour=info.getTimeDiff($(this).text(),now,"hour");if(hour>0){$(this).text(hour+" 小时前");$(this).addClass("highlight-color")}else if(hour==0){var minute=info.getTimeDiff($(this).text(),now,"minute");if(minute>0){$(this).text(minute+" 分钟前");$(this).addClass("highlight-color")}else if(minute==0){var second=info.getTimeDiff($(this).text(),now,"second");$(this).text(second+" 秒前");$(this).addClass("highlight-color")}}}})},tag:function(args){var settings=defaults(args);var id=settings.id;var maxNum=settings.maxNum;var html='';html+='<div class="tagator" style="line-height: 20px;">';html+='<div class="tags" style="display: inline;"></div>';html+='<input class="tag-input" autocomplete="false" maxlength="20" placeholder="输入标签按回车保存" onkeydown="if(event.keyCode==13){javaex.saveTag(this.value, \''+id+'\', \''+maxNum+'\');}">';html+='</div>';$(".tagbox").append(html);var tagArr=settings.tags;if(tagArr!=""&&tagArr!=null){var tag="";var tagHtml='';for(var i=0;i<tagArr.length;i++){if(i==0){tag=tagArr[i]}else{tag+=","+tagArr[i]}tagHtml+='<div class="tag">';tagHtml+='<span>'+tagArr[i]+'</span>';tagHtml+='<div class="tag-remove" onclick="javascript:javaex.removeTag(this, \''+tagArr[i]+'\', \''+id+'\');">×</div><div style="clear: both;"></div>';tagHtml+='</div>'}$("#"+id).val(tag);$(".tags").append(tagHtml)}},saveTag:function(tag,id,maxNum){if(tag.length>=20){return false}tag=tag.replace(/(^\s*)|(\s*$)/g,"");if(tag==""){return false}var result=$("#"+id).val();if(result==""){$("#"+id).val(tag)}else{var arr=result.split(",");if(arr.length>=parseInt(maxNum)){return false}for(var i=0;i<arr.length;i++){if(tag==arr[i]){return false}}$("#"+id).val(result+","+tag)}var html='';html+='<div class="tag">';html+='<span>'+tag+'</span>';html+='<div class="tag-remove" onclick="javascript:javaex.removeTag(this, \''+tag+'\', \''+id+'\');">×</div><div style="clear: both;"></div>';html+='</div>';$(".tag-input").val("");$(".tags").append(html)},removeTag:function(obj,tag,id){obj.parentNode.remove();var result=$("#"+id).val();var index=result.indexOf(","+tag);if(index==-1){result=result.replace(tag+",","");result=result.replace(tag,"")}else{result=result.replace(","+tag,"")}$("#"+id).val(result)},filter:function(args){var settings=defaults(args);var selector=settings.selector;$(selector).each(function(){if($(this).children("li.on").length==0){$(this).children("li").first().addClass("on")}});if(settings.isInit){callback()}$(selector+">li").click(function(){$(this).addClass("on").siblings().removeClass("on");var arr=new Array();$(selector).each(function(){var ulId=$(this).attr("id");var liValue=$(this).children("li.on").attr("val");arr.push(ulId+"="+liValue)});settings.callback(arr)});function callback(){var arr=new Array();$(selector).each(function(){var ulId=$(this).attr("id");var liValue=$(this).children("li.on").attr("val");arr.push(ulId+"="+liValue)});settings.callback(arr)}},score:function(args){var settings=defaults(args);var id=settings.id;var num=parseInt(settings.num);var scoreArr=settings.scoreArr;var isReadOnly=settings.isReadOnly;var size=settings.size;var liHtml='';for(var i=1;i<=num;i++){liHtml+='<li index="'+i+'" score="'+scoreArr[i-1]+'"><i class="star icon-star_border" style="font-size:'+size+'px;"></i></li>'}liHtml+='<strong class="level-text"></strong>';$("#"+id).append(liHtml);scoreChange=function(elem,index){return $(elem).each(function(i,scoreElem){return $(scoreElem).find("i").each(function(i,item){if(i<=index){$(item).removeClass("icon-star_border");return $(item).addClass("icon-star")}else{$(item).removeClass("icon-star");return $(item).addClass("icon-star_border")}})})};var score=settings.score;if(score!=""){$("#"+id+" li").each(function(){if($(this).attr("score")==score){$("#"+id).addClass("active");var index=$(this).attr("index");index--;$(this).parent().find(".level-text").html(settings.levelTextArr[index]);scoreChange($("#"+id),index);return false}})}if(!isReadOnly){$("#"+id+" li").hover(function(){var index=$(this).attr("index")|0;if(parseInt(index)<=0){return}index--;$(this).parent().find(".level-text").html(settings.levelTextArr[index]);return scoreChange($(this).parent(),index)});$("#"+id).mouseleave(function(){$(this).addClass("active");var index=$(this).attr("active")|0;index--;if(!isReadOnly){$(this).parent().find(".level-text").html("")}return scoreChange(this,index)});$("#"+id+" li").click(function(){var index=$(this).attr("index")|0;if(parseInt(index)<=0){return}$("#"+id).attr("active",index);scoreChange($("#"+id),index-1);settings.callback({"index":index,"score":$(this).attr("score")})})}},goTopBtn:function(args){var settings=defaults(args);var id=settings.id;$("#"+id).css("display","none");$("#"+id).click(function(){$("body, html").animate({scrollTop:0},500)});$(window).scroll(function(){var sc=$(window).scrollTop();if(sc>300){$("#"+id).css("display","block")}else{$("#"+id).css("display","none")}})},alert:function(args){var settings=defaults(args);var width=parseInt(settings.width);var maxHeight="";if(settings.maxHeight!=""){maxHeight=parseInt(settings.maxHeight)}$(".ex-opt-tip").remove();if(settings.mask==true||settings.mask=="true"){info.addMask()}var UUID=info.getUUID();if(settings.id!=""){UUID=settings.id}var alertHtml='<div id='+UUID+' class="ex-dialog animated zoomIn" style="width:'+width+'px;top:'+settings.top+';left:'+(document.documentElement.clientWidth-width)/2+'px;">';alertHtml+='<div id="dialog-top-'+UUID+'" class="dialog-top">';alertHtml+='<div class="dialog-title">'+settings.title+'</div>';if(settings.closeIcon==true||settings.closeIcon=="true"){alertHtml+='<div class="dialog-close-icon" onclick="javaex.close(\''+UUID+'\');"><span class="dialog-opt close"><span></div>'}alertHtml+='</div>';if(!!maxHeight){alertHtml+='<div class="dialog-content" style="overflow: auto;max-height:'+maxHeight+'px;text-align:'+settings.textAlign+';">'}else{alertHtml+='<div class="dialog-content" style="text-align:'+settings.textAlign+';">'}alertHtml+=settings.content;alertHtml+='</div>';alertHtml+='<div class="dialog-footer">';alertHtml+='<div class="dialog-btn-container">';alertHtml+='<button class="dialog-btn dialog-btn-true" onclick="if('+settings.callback+'!=false)javaex.close(\''+UUID+'\');">'+settings.confirmName+'</button>';alertHtml+='</div>';alertHtml+='</div>';alertHtml+='</div>';$(document.body).append(alertHtml);var oDialog=document.getElementById(UUID);var oDrag=document.getElementById("dialog-top-"+UUID);info.drag(oDialog,oDrag)},confirm:function(args){var settings=defaults(args);var width=parseInt(settings.width);$(".ex-opt-tip").remove();if(settings.mask==true||settings.mask=="true"){info.addMask()}var UUID=info.getUUID();var confirmHtml='<div id='+UUID+' class="ex-dialog animated zoomIn" style="width:'+width+'px;top:'+settings.top+';left:'+(document.documentElement.clientWidth-width)/2+'px;">';confirmHtml+='<div id="dialog-top-'+UUID+'" class="dialog-top">';confirmHtml+='<div class="dialog-title">'+settings.title+'</div>';if(settings.closeIcon==true||settings.closeIcon=="true"){confirmHtml+='<div class="dialog-close-icon" onclick="javaex.close(\''+UUID+'\');"><span class="dialog-opt close"><span></div>'}confirmHtml+='</div>';confirmHtml+='<div class="dialog-content" style="text-align:'+settings.textAlign+';">';confirmHtml+=settings.content;confirmHtml+='</div>';confirmHtml+='<div class="dialog-footer">';confirmHtml+='<div class="dialog-btn-container">';confirmHtml+='<button class="dialog-btn dialog-btn-true" onclick="if('+settings.callback+'!=false)javaex.close(\''+UUID+'\');">'+settings.confirmName+'</button>';confirmHtml+='<button class="dialog-btn dialog-btn-false" onclick="javaex.close(\''+UUID+'\');">'+settings.cancelName+'</button>';confirmHtml+='</div>';confirmHtml+='</div>';confirmHtml+='</div>';$(document.body).append(confirmHtml);var oDialog=document.getElementById(UUID);var oDrag=document.getElementById("dialog-top-"+UUID);info.drag(oDialog,oDrag)},deleteDialog:function(obj,args){$(".ex-danger-dialog").remove();var settings=defaults(args);var left=obj.getBoundingClientRect().left+document.documentElement.scrollLeft;var top=obj.getBoundingClientRect().top+document.documentElement.scrollTop;var UUID=info.getUUID();var html='<div id='+UUID+' class="ex-danger-dialog win animated fadeInUpSmall" style="left:'+parseInt(left-186+(obj.offsetWidth/2)+30)+'px;top:'+parseInt(top+obj.offsetHeight-50)+'px;">';html+='<button class="button red" onclick="if('+settings.callback+'!=false)javaex.close(\''+UUID+'\');"><span class="icon icon-check_circle"></span> '+settings.confirmName+'</button>';html+='<button class="button indigo" onclick="javaex.close(\''+UUID+'\');"><span class="icon icon-cancel"></span> '+settings.cancelName+'</button>';html+='</div>';var contentHtml='<div class="win win-hint animated fadeInUpSmall" style="top:-45px;">';contentHtml+='<div class="error-text" onclick="javaex.close(\''+UUID+'\');">';contentHtml+=settings.content;contentHtml+='</div>';contentHtml+='<div class="tail top"></div>';contentHtml+='</div>';$(document.body).append(html);setTimeout(function(){$("#"+UUID).append(contentHtml)},300)},followDialog:function(obj,args){$(".ex-panel").remove();var settings=defaults(args);var width=parseInt(settings.width);var type=settings.type;var position=settings.position;var left=obj.getBoundingClientRect().left+document.documentElement.scrollLeft;var top=obj.getBoundingClientRect().top+document.documentElement.scrollTop;var followHtml='';if(position=="down"){if(type=="arrow"){if(settings.alignment=="left"){followHtml+='<div class="ex-panel alignment-left" style="left:'+(left-30-9+(obj.offsetWidth/2))+'px;top:'+(top+obj.offsetHeight+3)+'px;width:'+width+'px;">'}else{followHtml+='<div class="ex-panel alignment-right" style="left:'+(left+(obj.offsetWidth/2)-width+30+9)+'px;top:'+(top+obj.offsetHeight+3)+'px;width:'+width+'px;">'}}else{if(settings.alignment=="left"){followHtml+='<div class="ex-panel" style="left:'+left+'px;top:'+(top+obj.offsetHeight+3)+'px;width:'+width+'px;">'}else{followHtml+='<div class="ex-panel" style="left:'+(left+obj.offsetWidth-width)+'px;top:'+(top+obj.offsetHeight+3)+'px;width:'+width+'px;">'}}}else if(position=="right"){followHtml+='<div class="ex-panel arrow-left" style="left:'+(left+obj.offsetWidth+3)+'px;width:'+width+'px;">'}followHtml+=settings.content;followHtml+='</div>';$(document.body).append(followHtml);if(position=="right"){$(".ex-panel").css("top",(top+obj.offsetHeight/2-$(".ex-panel").height()/2)+"px");$('head').append('<style>.ex-panel.arrow-left:before{left:-8px;top:'+($(".ex-panel").height()/2-9)+'px;}</style>')}$(document).mouseup(function(event){var obj=$(".ex-panel");if(!obj.is(event.target)&&obj.has(event.target).length==0){$(".ex-panel").remove()}})},timeoutId:null,optTip:function(args){var settings=defaults(args);var type=settings.type;var timeout=settings.timeout;var html='';if(type=="submit"){if(!!timeout){timeout=parseInt(timeout)}else{timeout=0}$(".ex-opt-tip").remove();html+='<div class="mask" style="background:none;"></div>';html+='<div class="ex-opt-tip animated fadeInDown" style="top: 40px; left: 50%;">';html+='<div style="display: flex;">';html+='<span class="tip-icon tip-icon-loading"></span>';html+='<span class="tip-msg">'+settings.content+'</span>';html+='</div>';html+='</div>';if(timeout>0){info.timeoutId=setInterval(function(){info.optTip({content:settings.timeoutText,type:"error"});clearInterval(info.timeoutId)},timeout)}}else if(type=="success"||type==""){clearInterval(info.timeoutId);if($(".tip-icon-loading").length>0){$(".ex-opt-tip").css("background-color","#79c37b");$(".ex-opt-tip .tip-icon").removeClass("tip-icon-loading");$(".ex-opt-tip .tip-icon").addClass("icon-check");$(".ex-opt-tip .tip-icon").css({"font-size":"16px","font-weight":"bold"});$(".ex-opt-tip .tip-msg").text(settings.content)}else{$(".ex-opt-tip").remove();html+='<div class="ex-opt-tip animated fadeInDown" style="top: 40px; left: 50%; background-color:#79c37b;">';html+='<div style="display: flex;">';html+='<span class="tip-icon icon-check" style="font-size:16px; font-weight:bold;"></span>';html+='<span class="tip-msg">'+settings.content+'</span>';html+='</div>';html+='</div>'}}else if(type=="error"){clearInterval(info.timeoutId);if($(".tip-icon-loading").length>0){$(".ex-opt-tip").css("background-color","#ff6e6e");$(".ex-opt-tip .tip-icon").removeClass("tip-icon-loading");$(".ex-opt-tip .tip-icon").addClass("icon-close");$(".ex-opt-tip .tip-icon").css({"font-size":"16px","font-weight":"bold"});$(".ex-opt-tip .tip-msg").text(settings.content)}else{$(".ex-opt-tip").remove();html+='<div class="ex-opt-tip animated fadeInDown" style="top: 40px; left: 50%; background-color:#ff6e6e;">';html+='<div style="display: flex;">';html+='<span class="tip-icon icon-close" style="font-size:16px; font-weight:bold;"></span>';html+='<span class="tip-msg">'+settings.content+'</span>';html+='</div>';html+='</div>'}$(".mask").remove()}$(document.body).append(html);var tipWidth=$(".ex-opt-tip").width();$(".ex-opt-tip").css("margin-left",-(tipWidth/2)+"px");if(type=="success"||type=="error"){setTimeout(function(){$(".ex-opt-tip").remove();$(".mask").remove()},settings.live)}},message:function(args){var settings=defaults(args);var type=settings.type;var timeout=settings.timeout;$(".mask").remove();$(".ex-opt-tip").remove();var html='';if(type=="submit"){if(!!timeout){timeout=parseInt(timeout)}else{timeout=0}$(".message-feedback").remove();html+='<div class="mask" style="background:none;"></div>';html+='<div class="message-feedback animated zoomIn">';html+='<div class="message-feedback-icons submit">';html+='<span class="message-feedback-icon icon-submited"></span>';html+='<span class="message-feedback-text">'+settings.content+'</span>';html+='</div>';html+='</div>';if(timeout>0){info.timeoutId=setInterval(function(){info.message({content:settings.timeoutText,type:"error"});clearInterval(info.timeoutId)},timeout)}}else if(type=="success"){clearInterval(info.timeoutId);$(".message-feedback").remove();html+='<div class="message-feedback animated zoomIn">';html+='<div class="message-feedback-icons succeed">';html+='<span class="message-feedback-icon icon-succeed"></span>';html+='<span class="message-feedback-text">'+settings.content+'</span>';html+='</div>';html+='</div>'}else if(type=="error"){clearInterval(info.timeoutId);$(".message-feedback").remove();html+='<div class="message-feedback animated zoomIn">';html+='<div class="message-feedback-icons failed">';html+='<span class="message-feedback-icon icon-failed"></span>';html+='<span class="message-feedback-text">'+settings.content+'</span>';html+='</div>';html+='</div>';$(".mask").remove()}$(document.body).append(html);var messageWidth=$(".message-feedback").width();$(".message-feedback").css("margin-left",-(messageWidth/2));if(type=="success"||type=="error"){setTimeout(function(){$(".message-feedback").remove();$(".mask").remove()},settings.live)}},loading:function(args){var settings=defaults(args);var containerId=settings.containerId;var id=settings.id;var type=settings.type;var content=settings.content;if(!content){content="正在读取数据，请稍候..."}var top=settings.top;if(!type){$(document.body).append('<div id="javaex-loading" class="javaex-loading">'+content+'</div>');document.onreadystatechange=subSomething;function subSomething(){if(document.readyState=="complete"){var oLoading=document.getElementById("javaex-loading");if(oLoading!=null){oLoading.remove();settings.callback({"code":"000000"})}}}}else if(type=="close"){if(containerId!=""){$("#"+containerId).css({"min-height":""})}if(id==""){$(".javaex-process").remove()}else{$("#"+id).remove()}}else if(type=="open"){if(containerId==""){if(id==""){$(document.body).append('<div class="javaex-process"></div>')}else{$(document.body).append('<div id="'+id+'" class="javaex-process"></div>')}}else{var tempHeight=$("#"+containerId).height();if(tempHeight<140){$("#"+containerId).css({"min-height":"140px"})}if(id==""){$("#"+containerId).append('<div class="javaex-process" style="top:'+top+';"></div>')}else{$("#"+containerId).append('<div id="'+id+'" class="javaex-process" style="top:'+top+';"></div>')}}}},num:0,dialog:function(args){var settings=defaults(args);var width=parseInt(settings.width);var offsetLeft=parseInt(settings.offsetLeft);var height=settings.height;if(height!=""){height=parseInt(height)}var hasBackground=settings.hasBackground;var type=settings.type;attribute=args;var UUID=info.getUUID();if(settings.id!=""){UUID=settings.id}var dialogHtml='';if(type=="image"){info.addMask();var image=new Image();image.src=settings.url;var maxWidth=document.documentElement.clientWidth-120;var maxHeight=document.documentElement.clientHeight-120;var arr=info.autoWidthHeight(image.width,image.height,maxWidth,maxHeight);width=arr[0]+40;height=arr[1]+40;dialogHtml='<div id='+UUID+' class="ex-dialog animated zoomIn" style="width:'+width+'px;height:'+height+'px;left:'+(maxWidth-width+120)/2+'px;">';dialogHtml+='<div class="dialog-content" style="padding: 0;">';dialogHtml+='<img src="'+settings.url+'" />';dialogHtml+='</div>';dialogHtml+='<a class="close2" href="javascript:;" onclick="javaex.close(\''+UUID+'\');"></a>';dialogHtml+='</div>'}else if(type=="images"){var selector=settings.selector;var placeholder=settings.placeholder;var original=settings.dataOriginal;$(selector).each(function(i){if($(this).attr("src")==settings.url){info.num=i}});var image=new Image();image.src=settings.url;var maxWidth=document.documentElement.clientWidth-120;var maxHeight=document.documentElement.clientHeight-120;var arr=info.autoWidthHeight(image.width,image.height,maxWidth,maxHeight);width=arr[0];height=arr[1];dialogHtml='<div class="ex-allcover"></div>';dialogHtml+='<div id="'+UUID+'" class="ex-area-window">';dialogHtml+='<div id="ex-box-image-manga" style="width:'+width+'px;height:'+height+'px;left:'+(maxWidth-width+120)/2+'px;top:'+(maxHeight-height+120)/2+'px;">';dialogHtml+='<img id="img-'+UUID+'" src="'+settings.url+'" style="opacity: 1;">';dialogHtml+='</div>';dialogHtml+='<div class="prev-image" title="上一张" onclick="javaex.lastImg(\''+UUID+'\', \''+selector+'\', \''+placeholder+'\', \''+original+'\');">';dialogHtml+='<i class="icon icon-chevron-circle-left"></i>';dialogHtml+='</div>';dialogHtml+='<div class="next-image" title="下一张" onclick="javaex.nextImg(\''+UUID+'\', \''+selector+'\', \''+placeholder+'\', \''+original+'\');">';dialogHtml+='<i class="icon icon-chevron-circle-right"></i>';dialogHtml+='</div>';dialogHtml+='<div class="area-tool-image">';dialogHtml+='<a id="ex-btn-quit-image" class="button red" href="javascript:;" onclick="javaex.close(\''+UUID+'\');">';dialogHtml+='<i class="icon icon-cancel" style="vertical-align: middle;height: 30px;line-height: 28px;font-size: 16px;"></i>退出读图模式';dialogHtml+='</a>';dialogHtml+='</div>';dialogHtml+='</div>'}else if(type=="dialog"||type=="login"){info.addMask();dialogHtml='<div id='+UUID+' class="ex-dialog animated zoomIn" style="box-shadow: none;width:'+width+'px;left:'+((document.documentElement.clientWidth-width)/2-offsetLeft)+'px;">';dialogHtml+='<div id="dialog-content-'+UUID+'" class="dialog-content" style="padding:0;height:'+height+'px;">';dialogHtml+='<iframe src="'+settings.url+'" width="100%" height="100%" frameborder="0" scrolling="no" style="overflow: visible;border: 0;"></iframe>';dialogHtml+='</div>';dialogHtml+='<a class="dialog-close icon-close" href="javascript:;" onclick="javaex.close(\''+UUID+'\');"></a>';dialogHtml+='</div>'}else if(type=="window"){if(settings.mask==true||settings.mask=="true"){info.addMask()}dialogHtml='<div id='+UUID+' class="ex-dialog animated zoomIn" style="width:'+width+'px;top:'+(document.documentElement.clientHeight-height)/2+'px;left:'+((document.documentElement.clientWidth-width)/2-offsetLeft)+'px;height:'+height+'px;">';dialogHtml+='<div class="dialog-top">';dialogHtml+='<div id="dialog-title-'+UUID+'" class="dialog-title">'+settings.title+'</div>';dialogHtml+='<div id="dialog-min-'+UUID+'" class="dialog-min-icon" onclick="javaex.min(\''+UUID+'\');"><span class="dialog-opt min"><span></div>';dialogHtml+='<div id="dialog-max-'+UUID+'" class="dialog-max-icon" onclick="javaex.max(\''+UUID+'\');"><span class="dialog-opt max"><span></div>';dialogHtml+='<div id="dialog-revert-'+UUID+'" style="display:none;" class="dialog-revert-icon" onclick="javaex.revert(\''+UUID+'\', attribute);"><span class="dialog-opt revert"><span></div>';dialogHtml+='<div class="dialog-close-icon" onclick="if('+settings.closeX+'!=false)javaex.close(\''+UUID+'\');"><span class="dialog-opt close"><span></div>';dialogHtml+='</div>';if(hasBackground){dialogHtml+='<div id="dialog-content-'+UUID+'" class="dialog-content full" style="height:'+(height-40)+'px;overflow-y:hidden;">'}else{dialogHtml+='<div id="dialog-content-'+UUID+'" class="dialog-content" style="height:'+(height-40)+'px;overflow-y:hidden;">'}dialogHtml+='<iframe src="'+settings.url+'" width="100%" height="100%" frameborder="0" scrolling="'+settings.scrolling+'" style="overflow: visible;border: 0;"></iframe>';dialogHtml+='</div>';dialogHtml+='<div id="dialog-resize-'+UUID+'" class="resize" onmousemove="javaex.resize(\''+UUID+'\', attribute);"></div>';dialogHtml+='</div>'}$(document.body).append(dialogHtml);var oDialog=document.getElementById(UUID);if(type=="login"||type=="dialog"){var heightDifference=document.documentElement.clientHeight-oDialog.offsetHeight;oDialog.style.top=(heightDifference/2)+"px";if(settings.isClickMaskClose){$(".mask").click(function(){info.close(UUID)})}}else if(type=="image"){var heightDifference=document.documentElement.clientHeight-oDialog.offsetHeight;oDialog.style.top=(heightDifference/2)+"px";$(".mask").click(function(){info.close(UUID)})}else if(type=="window"){var oDrag=document.getElementById("dialog-title-"+UUID);info.drag(oDialog,oDrag);if(settings.isClickMaskClose){$(".mask").click(function(){info.close(UUID)})}}},autoWidthHeight:function(width,height,maxWidth,maxHeight){if(width<maxWidth&&height<maxHeight){}else{if(maxWidth/maxHeight<=width/height){width=maxWidth;height=maxWidth*(height/width)}else{width=maxHeight*(width/height);height=maxHeight}}var arr=new Array(width,height);return arr},lastImg:function(UUID,selector,placeholder,original){info.num--;if(info.num>=0){$("#img-"+UUID).css({"opacity":0,"transition":"opacity 200ms ease 0s"});setTimeout(function(){var image=new Image();image.src=$(selector).eq(info.num).attr("src");var maxWidth=document.documentElement.clientWidth-120;var maxHeight=document.documentElement.clientHeight-120;var arr=info.autoWidthHeight(image.width,image.height,maxWidth,maxHeight);width=arr[0];height=arr[1];$("#ex-box-image-manga").css({"width":width+"px","height":height+"px","left":(maxWidth-width+120)/2+"px","top":(maxHeight-height+120)/2+"px"});$("#img-"+UUID).attr("src",image.src);$("#img-"+UUID).css({"opacity":1,"transition":""})},200)}else{info.num=$(selector).length-2;info.nextImg(UUID,selector,placeholder,original)}},nextImg:function(UUID,selector,placeholder,original){info.num++;if(info.num<$(selector).length){$("#img-"+UUID).css({"opacity":0,"transition":"opacity 200ms ease 0s"});setTimeout(function(){var image=new Image();var imgSrc=$(selector).eq(info.num).attr("src");if(imgSrc.indexOf(placeholder)!=-1){imgSrc=$(selector).eq(info.num).attr(original)}image.src=imgSrc;var maxWidth=document.documentElement.clientWidth-120;var maxHeight=document.documentElement.clientHeight-120;var arr=info.autoWidthHeight(image.width,image.height,maxWidth,maxHeight);width=arr[0];height=arr[1];$("#ex-box-image-manga").css({"width":width+"px","height":height+"px","left":(maxWidth-width+120)/2+"px","top":(maxHeight-height+120)/2+"px"});$("#img-"+UUID).attr("src",image.src);$("#img-"+UUID).css({"opacity":1,"transition":""})},200)}else{info.num=-1;info.nextImg(UUID,selector,placeholder,original)}},resize:function(UUID,args){var settings=defaults(args);var dragMinWidth=parseInt(settings.width);var dragMinHeight=parseInt(settings.height);var oDialog=document.getElementById(UUID);var oResize=document.getElementById("dialog-resize-"+UUID);oResize.onmousedown=function(event){var oEvent=event||window.event;var absX=oEvent.clientX-oResize.offsetLeft;var absY=oEvent.clientY-oResize.offsetTop;document.onmousemove=function(eve){var oEve=eve||window.event;var offsetLeft=oEve.clientX-absX;var offsetTop=oEve.clientY-absY;var maxWidth=document.documentElement.clientWidth-oDialog.offsetLeft-2;var maxHeight=document.documentElement.clientHeight-oDialog.offsetTop-2;var offsetWidth=oResize.offsetWidth+offsetLeft;var offsetHeight=oResize.offsetHeight+offsetTop;if(offsetWidth<dragMinWidth){offsetWidth=dragMinWidth}if(offsetWidth>maxWidth){offsetWidth=maxWidth}oDialog.style.width=offsetWidth+"px";if(offsetHeight<dragMinHeight){offsetHeight=dragMinHeight}if(offsetHeight>maxHeight){offsetHeight=maxHeight}oDialog.style.height=offsetHeight+"px";document.getElementById("dialog-content-"+UUID).style.height=(offsetHeight-40)+"px";return false};document.onmouseup=function(){document.onmousemove=null;document.onmouseup=null};return false}},min:function(UUID){var oMin=document.getElementById("dialog-min-"+UUID);oMin.style.display="none";var oResize=document.getElementById("dialog-resize-"+UUID);oResize.style.display="none";var oMax=document.getElementById("dialog-max-"+UUID);oMax.style.display="none";var oRevert=document.getElementById("dialog-revert-"+UUID);oRevert.style.display="block";var oContent=document.getElementById("dialog-content-"+UUID);oContent.style.display="none";var oDialog=document.getElementById(UUID);oDialog.style.left="0";oDialog.style.width="260px";oDialog.style.height="40px";offsetTop=document.documentElement.clientHeight-oDialog.offsetHeight;oDialog.style.top=offsetTop+"px"},max:function(UUID){var oMax=document.getElementById("dialog-max-"+UUID);oMax.style.display="none";var oResize=document.getElementById("dialog-resize-"+UUID);oResize.style.display="none";var oMin=document.getElementById("dialog-min-"+UUID);oMin.style.display="block";var oRevert=document.getElementById("dialog-revert-"+UUID);oRevert.style.display="block";var oDialog=document.getElementById(UUID);oDialog.style.top="0";oDialog.style.left="0";oDialog.style.width=document.documentElement.clientWidth-2+"px";oDialog.style.height=document.documentElement.clientHeight-2+"px";var oContent=document.getElementById("dialog-content-"+UUID);oContent.style.display="block";oContent.style.height=document.documentElement.clientHeight-2-40+"px"},revert:function(UUID,args){var settings=defaults(args);var width=parseInt(settings.width);var height=parseInt(settings.height);var oMin=document.getElementById("dialog-min-"+UUID);oMin.style.display="block";var oRevert=document.getElementById("dialog-revert-"+UUID);oRevert.style.display="none";var oMax=document.getElementById("dialog-max-"+UUID);oMax.style.display="block";var oResize=document.getElementById("dialog-resize-"+UUID);oResize.style.display="block";var oDialog=document.getElementById(UUID);oDialog.style.top=settings.top;oDialog.style.left=(document.documentElement.clientWidth-width)/2+"px";oDialog.style.width=width+"px";oDialog.style.height=height+"px";oDialog.style.top=(document.documentElement.clientHeight-height)/2+"px";var oContent=document.getElementById("dialog-content-"+UUID);oContent.style.display="block";oContent.style.height=(height-40)+"px"},close:function(UUID){if(!UUID){$(".ex-dialog").removeClass("zoomIn");$(".ex-dialog").addClass("zoomOut");$(".mask").remove();setTimeout(function(){$(".ex-dialog").remove()},300)}else{if($("#"+UUID).hasClass("ex-area-window")){$("#"+UUID).remove();$(".ex-allcover").remove()}else if($("#"+UUID).hasClass("ex-danger-dialog")){$("#"+UUID).removeClass("fadeInUpSmall");$("#"+UUID).addClass("zoomOut");setTimeout(function(){$("#"+UUID).remove()},300)}else{$("#"+UUID).removeClass("zoomIn");$("#"+UUID).addClass("zoomOut");$(".mask").remove();setTimeout(function(){$("#"+UUID).remove()},300)}}},addMask:function(){$(document.body).append('<div class="mask"></div>')},addMask2:function(){$(document.body).append('<div class="mask" style="background:none;"></div>')},drag:function(oDialog,oDrag){oDrag.onmousedown=function(event){var oEvent=event||window.event;var absX=oEvent.clientX-oDialog.offsetLeft;var absY=oEvent.clientY-oDialog.offsetTop;document.onmousemove=function(eve){var oEve=eve||window.event;var offsetLeft=oEve.clientX-absX;var offsetTop=oEve.clientY-absY;if(offsetLeft<=0){offsetLeft=0}else if(offsetLeft>=(document.documentElement.clientWidth-oDialog.offsetWidth)){offsetLeft=document.documentElement.clientWidth-oDialog.offsetWidth}if(offsetTop<=0){offsetTop=0}else if(offsetTop>=(document.documentElement.clientHeight-oDialog.offsetHeight)){offsetTop=document.documentElement.clientHeight-oDialog.offsetHeight}oDialog.style.left=offsetLeft+"px";oDialog.style.top=offsetTop+"px"};document.onmouseup=function(){document.onmousemove=null;document.onmouseup=null}}},popin:function(id){if(!!id){$("#"+id+" .pop-in").each(function(){$(this).css("animation-delay",Math.random()+"s")})}else{$(".pop-in").each(function(){$(this).css("animation-delay",Math.random()+"s")})}},render:function(args){var settings=defaults(args);var id=settings.id;var type=settings.type;if(!!id){if(!!type){if(type=="equal"){var classArr=$('#'+id).attr("class").split(" ");for(var i=0;i<classArr.length;i++){if(classArr[i].indexOf("equal-")>=0){var num=classArr[i].split("-")[1];$('#'+id).children("li").css("width",(100/num)+"%")}}return}if(type=="grid"){var classArr=$('#'+id).attr("class").split(" ");for(var i=0;i<classArr.length;i++){if(classArr[i].indexOf("grid-")>=0){var arr=classArr[i].split("-");var sum=0;for(var j in arr){if(j>0){sum=parseInt(sum)+parseInt(arr[j])}}$('#'+id).children("div").each(function(k){$(this).css("width",(100/sum)*arr[k+1]+"%")})}else if(classArr[i].indexOf("spacing-")>=0){var spacing=classArr[i].split("-")[1];var width="calc(100% + "+parseInt(spacing)+"px)";$('#'+id).css("width",width);$('#'+id).children("div").each(function(k){$(this).css("margin-right",parseInt(spacing)+"px")})}}}}}else{$("script").each(function(){if(!!$(this).attr("src")){if($(this).attr("src").indexOf("common.js")>-1){var jsSrc=$(this).attr("src");var script=document.createElement("script");script.src=jsSrc;$(document.body).append(script)}if($(this).attr("src").indexOf("javaex-formVerify.js")>-1){var jsSrc=$(this).attr("src");var script=document.createElement("script");script.src=jsSrc;$(document.body).append(script)}}})}},menu:function(args){var settings=defaults(args);var menuId=settings.id;if(settings.isShowAll){$("#"+menuId+" .menu-item").addClass("menu-show");$("#"+menuId+" .menu-item>ul").css("display","block")}$("#"+menuId+" .menu-item>a").on("click",function(){if($(this).next().css("display")=="none"){if(!settings.isShowAll){$("#"+menuId+" .menu-item").children("ul").slideUp(300)}$(this).next("ul").slideDown(300);if(settings.isShowAll){$(this).parent("li").addClass("menu-show")}else{$(this).parent("li").addClass("menu-show").siblings("li").removeClass("menu-show")}}else{if($(this).next("ul").length==0){$("#"+menuId+" .menu-item.menu-show ul").slideUp(300)}else{$(this).next("ul").slideUp(300)}if(settings.isShowAll){$(this).parent("li").removeClass("menu-show")}else{$("#"+menuId+" .menu-item.menu-show").removeClass("menu-show")}}});var menuFlag=0;$("#"+menuId+" li.menu-item>a").click(function(){menuFlag=1;addHover($(this).parent())});$("#"+menuId+" li.menu-item ul li>a").click(function(){menuFlag=2;addHover($(this).parent())});function addHover(obj){if(menuFlag==1){$("#"+menuId+" li.menu-item").removeClass("hover")}else if(menuFlag==2){$("#"+menuId+" li.menu-item ul li").removeClass("hover")}else{$("#"+menuId+" li.menu-item").removeClass("hover");$("#"+menuId+" li.menu-item ul li").removeClass("hover")}obj.addClass("hover")}if(settings.isAutoSelected){var url=window.location.href;var flag=menuSelected(url);if(flag==false){if(!settings.key){delCookie("adminMenuUrl");menuSelected(settings.url)}else{var host=window.location.host;if(url==("http://"+host+"/")||url==("https://"+host+"/")||url==("http://"+host)||url==("https://"+host)){delCookie("adminMenuUrl")}else{var url=getCookie("adminMenuUrl");menuSelected(url)}}}}function menuSelected(url){var url2=url.replace(window.location.host,"").replace("http://","").replace("https://","");var flag=false;var menuFlag=false;$("#"+menuId+" li").each(function(){var href=$(this).children().first().attr("href");if(href.indexOf("javascript:page")>=0){href=href.replace(/"/g,"'");href=href.replace("javascript:page('","").replace("');","").replace("')","")}if(url2==href){menuFlag=true;flag=true;setCookie("adminMenuUrl",url);if($(this).hasClass("menu-item")){$("#menu li.menu-item").removeClass("hover");$("#menu li.menu-item ul li").removeClass("hover");$(this).addClass("hover")}else{$(this).addClass("hover").siblings().removeClass("hover");$(this).parent().parent().addClass("menu-show")}return}});if(!menuFlag){$("#"+menuId+" li").each(function(){var href=$(this).children().first().attr("href");if(url.indexOf(href)>=0){flag=true;setCookie("adminMenuUrl",url);if($(this).hasClass("menu-item")){$("#menu li.menu-item").removeClass("hover");$("#menu li.menu-item ul li").removeClass("hover");$(this).addClass("hover")}else{$(this).addClass("hover").siblings().removeClass("hover");$(this).parent().parent().addClass("menu-show")}return}})}return flag}function setCookie(key,value){document.cookie=key+"="+value+"; path=/; expires=-1"}function getCookie(key){var keyName=key+"=";var arr=document.cookie.split("; ");for(var i=0;i<arr.length;i++){var cookieName=arr[i].trim();if(cookieName.indexOf(keyName)==0){return cookieName.substring(keyName.length,cookieName.length)}}return""}function delCookie(key){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=getCookie(key);if(cval!=null){document.cookie=key+"="+cval+";expires="+exp.toGMTString()}}},tab:function(args){var settings=defaults(args);var tabId=settings.id;var current=parseInt(settings.current);var mode=settings.mode;var display=settings.display;$("#"+tabId+" .tab-title ul li").each(function(i){if(i==(current-1)){$(this).addClass("current")}});$("#"+tabId+" .tab-content>div").each(function(i){if(i==(current-1)){$(this).css("display",display)}else{$(this).css("display","none")}});if(settings.isInit){settings.callback({"index":current})}if(mode=="mouseover"){$("#"+tabId+" .tab-title ul li").mouseover(function(){$this=$(this);setTimeout(function(){$this.addClass("current").siblings().removeClass("current");$("#"+tabId+" .tab-content>div:eq("+$this.index()+")").show().siblings().hide();$(settings.container).trigger(settings.event);settings.callback({"index":$this.index()+1})},settings.delay)})}else if(mode=="click"){$("#"+tabId+" .tab-title ul li").click(function(){$(this).addClass("current").siblings().removeClass("current");$("#"+tabId+" .tab-content>div:eq("+$(this).index()+")").show().siblings().hide();$(settings.container).trigger(settings.event);settings.callback({"index":$(this).index()+1})})}},table:function(args){var settings=defaults(args);var tableId=settings.id;var mergeColArr=settings.mergeColArr;var tree=settings.tree;if(mergeColArr.length>0){for(var i=0;i<mergeColArr.length;i++){tableMerge($("#"+tableId),mergeColArr[i]-1)}$("#"+tableId).removeData()}if(parseInt(tree)>0){$("#"+tableId+" tbody tr").each(function(){setPaddingLeft($(this))});$("#"+tableId+" .icon-caret-down, #"+tableId+" icon-caret-right").on("click",function(e){if($(this).hasClass("icon-caret-down")){$(this).addClass("icon-caret-right").removeClass("icon-caret-down")}else{$(this).addClass("icon-caret-down").removeClass("icon-caret-right")}var flag=false;var objTr=$(this).closest("tr");objTr.nextAll("tr").each(function(){var parentId=$(this).attr("parentId");if(parentId==objTr.attr("id")){if($(this).is(":hidden")){flag=true;$(this).show()}}});if(!flag){hideTr(objTr)}e.stopPropagation()});if(settings.isClose){$("#"+tableId+" .icon-caret-down").each(function(){if($(this).closest("tr").is(":visible")){$(this).click()}})}}function setPaddingLeft(objTr){var flag=false;var id=objTr.attr("id");objTr.nextAll("tr").each(function(){if($(this).attr("parentId")==id){flag=true;if(objTr.children("td:eq("+(tree-1)+")").children("span.icon-caret-down").length==0){objTr.children("td:eq("+(tree-1)+")").prepend('<span class="tree-icon icon-caret-down" style="font-size: 16px;"></span>')}var paddingLeft=parseInt($(this).children("td:eq("+(tree-1)+")").css("padding-left"));$(this).children("td:eq("+(tree-1)+")").css("padding-left",(paddingLeft+16)+"px");setPaddingLeft($(this))}});if(!flag){var objTd=objTr.children("td:eq("+(tree-1)+")");objTd.children("span.icon-caret-down").remove();objTr.prevAll().each(function(){if($(this).children("td:eq("+(tree-1)+")").children("span.icon-caret-down").length>0){var paddingLeft=parseInt($(this).children("td:eq("+(tree-1)+")").css("padding-left"));if(objTd.closest("tr").attr("parentId")==$(this).attr("id")){objTd.css("padding-left",(paddingLeft+40)+"px")}else{objTd.css("padding-left",(paddingLeft+16)+"px")}return false}})}}function hideTr(objTr){var id=objTr.attr("id");objTr.nextAll("tr").each(function(){if($(this).attr("parentId")==id){if($(this).children("td:eq("+(tree-1)+")").children("span.icon-caret-down").length>0){$(this).children("td:eq("+(tree-1)+")").children("span.icon-caret-down").addClass("icon-caret-right").removeClass("icon-caret-down")}$(this).hide();hideTr($(this))}})}function tableMerge(obj,colIndex){obj.data("content","");obj.data("rowspan",1);obj.data("td",$());obj.data("trNum",$("#"+tableId+" tbody tr").length);$("tbody tr",obj).each(function(index){var $tr=$(this);var $td=$("td:eq("+colIndex+")",$tr);var currentContent=$td.html();if(obj.data("content")==""){obj.data("content",currentContent);obj.data("td",$td)}else{if(obj.data("content")==currentContent){addRowspan()}else{newRowspan()}}function addRowspan(){var rowspan=obj.data("rowspan")+1;obj.data("rowspan",rowspan);$td.hide();if(++index==obj.data("trNum")){obj.data("td").attr("rowspan",obj.data("rowspan"))}}function newRowspan(){if(obj.data("rowspan")!=1){obj.data("td").attr("rowspan",obj.data("rowspan"))}obj.data("td",$td);obj.data("content",$td.html());obj.data("rowspan",1)}})}},select:function(args){var settings=defaults(args);var selectId=settings.id;var hasInputName=settings.hasInputName;$("#span-"+selectId).remove();$("#"+selectId).css("display","none");var selectHtml='<span id="span-'+selectId+'" style="position: relative;">';if(settings.isSearch){if(hasInputName){selectHtml+='<input id="input-'+selectId+'" name="input-'+selectId+'" type="text" class="select" oninput="javaex.selectSearch(\''+selectId+'\', this.value)" />'}else{selectHtml+='<input id="input-'+selectId+'" type="text" class="select" oninput="javaex.selectSearch(\''+selectId+'\', this.value)" />'}}else{if(hasInputName){selectHtml+='<input id="input-'+selectId+'" name="input-'+selectId+'" type="text" class="select" readonly />'}else{selectHtml+='<input id="input-'+selectId+'" type="text" class="select" readonly />'}}selectHtml+='<span id="icon-'+selectId+'" class="icon-expand_more"></span>';selectHtml+='<ul id="ul-'+selectId+'" class="select-ul">';selectHtml+='</ul>';selectHtml+='</span>';$("#"+selectId).before(selectHtml);if($("#"+selectId).prop("disabled")){$("#input-"+selectId).addClass("disabled")}$("#icon-"+selectId).css({"position":"absolute","right":"6px","font-size":"20px","color":"#999","top":"0"});var zoom=$("#"+selectId).attr("zoom");if(zoom!=null){$("#span-"+selectId).css("zoom",zoom)}var width=$("#"+selectId).width();if(width<140){width=140}$("#input-"+selectId).css("width",width+"px");$("#ul-"+selectId).empty();$("#ul-"+selectId).html($("#"+selectId).html());$("#ul-"+selectId+" option").addClass("select-ul-item");$("#ul-"+selectId+" option").each(function(){if($(this).val()==$("#"+selectId).val()){$(this).addClass("select-ul-item-selected");$("#input-"+selectId).val($(this).text());if(settings.isInit){settings.callback({"selectValue":$(this).val(),"selectName":$(this).text()})}return false}});$("#ul-"+selectId).css("max-height",28*parseInt(settings.maxNum)+2+"px");$("#span-"+selectId).click(function(event){if($("#"+selectId).prop("disabled")){event.preventDefault()}else{$("#ul-"+selectId+" option").removeClass("select-ul-item-selected");$("#ul-"+selectId+" option").each(function(){if($(this).val()==$("#"+selectId).val()){$(this).addClass("select-ul-item-selected");return false}});$("#ul-"+selectId+" option").css("display","block");$(this).find("ul").css({"width":$(this).find("input").width()+22,"display":"block"});event.stopPropagation()}});$("#ul-"+selectId+" option").on("click",function(event){var selectValue=$(this).val();var selectName=$(this).text();$("#"+selectId).val(selectValue);$("#input-"+selectId).val($(this).text());$("#ul-"+selectId).css("display","none");if($(this).parent().parent().parent().hasClass("error-parent")){$(this).parent().parent().parent().removeClass("error-parent");$(this).parent().parent().parent().find(".win-hint").remove()}settings.callback({"selectValue":selectValue,"selectName":selectName});if(!!$("#"+selectId).attr("onchange")){$("#"+selectId).trigger("change")}event.stopPropagation()});$(document).click(function(){$("#ul-"+selectId).css("display","none")})},selectSearch:function(selectId,keyword){var count=0;keyword=keyword.replace(/(^\s*)|(\s*$)/g,"");if(keyword==""){$("#ul-"+selectId+" option").show()}else{$("#ul-"+selectId+" option").each(function(i){if($(this).text().toLowerCase().indexOf(keyword.toLowerCase())==-1){$(this).css("display","none");count++}else{$(this).css("display","block")}})}},page:function(args){var settings=defaults(args);var pageId=settings.id;var pageCount=settings.pageCount;if(pageCount==null){return false}pageCount=parseInt(pageCount);var currentPage=parseInt(settings.currentPage);if(currentPage<1||currentPage>pageCount){currentPage=1}var goPageNum=currentPage;var perPageCount=null;if(!!settings.perPageCount){perPageCount=parseInt(settings.perPageCount)}var totalNum=null;if(!!settings.totalNum){totalNum=settings.totalNum}var isShowJumpPage=settings.isShowJumpPage;var position=settings.position;if(position=="left"){$("#"+pageId).parent().css("text-align","left")}else if(position=="center"){$("#"+pageId).parent().css("text-align","center")}else if(position=="right"){$("#"+pageId).parent().css("text-align","right")}if(pageCount<=1){$("#"+pageId).append('');return}else if(pageCount<7){var perPageCountHtml='';if(!!perPageCount){perPageCountHtml+='<span class="hint"><select id="javaex-perPageCount-'+pageId+'" class="select">';for(var i=1;i<10;i++){if(i*10==perPageCount){perPageCountHtml+='<option value="'+i+'0" selected>'+i+'0 条/页</option>'}else{perPageCountHtml+='<option value="'+i+'0">'+i+'0 条/页</option>'}}perPageCountHtml+='</select></span>'}var html='<li><a>上一页</a></li>';for(var i=1;i<=pageCount;i++){if(i==currentPage){html+='<li class="active" page="'+i+'"><a>'+i+'</a></li>'}else{html+='<li page="'+i+'"><a>'+i+'</a></li>'}}html+='<li><a>下一页</a></li>';$("#"+pageId).append(perPageCountHtml);$("#"+pageId).append(html);init(pageId)}else{newPages(pageId,"jump",currentPage)}function init(pageId){$("#javaex-button-mini-"+pageId).click(function(){var goPageNum=$("#javaex-pager-"+pageId).val();goPageNum=parseInt(goPageNum);if(isNaN(goPageNum)){goPageNum=1}else{if(goPageNum<1){goPageNum=1}else if(goPageNum>pageCount){goPageNum=pageCount}}currentPage=goPageNum;newPages(pageId,"jump",goPageNum);settings.callback({"pageNum":goPageNum,"perPageCount":perPageCount})});$("#javaex-perPageCount-"+pageId).change(function(){currentPage=activePage(pageId,$("#"+pageId).children("li.active"));if(!!perPageCount){perPageCount=$("#javaex-perPageCount-"+pageId).val()}settings.callback({"pageNum":currentPage,"perPageCount":perPageCount})});$("#"+pageId).children("li").click(function(){var element=$(this);var pageText=$(this).children("a").text();var currentPage="";var lastPage=$("#"+pageId).children("li.active").attr("page");if(isNaN(pageText)){switch(pageText){case"上一页":if(lastPage=="1"){return}if(lastPage>=(pageCount-1)||lastPage<=3||pageCount<7){element=$("#"+pageId).children("li.active").prev()}else{newPages(pageId,"prev",(parseInt(lastPage)-1));element=$("#"+pageId).children("li.active")}break;case"下一页":if(lastPage==pageCount){return}if(lastPage>=(pageCount-2)||lastPage<3||pageCount<7){element=$("#"+pageId).children("li.active").next()}else{newPages(pageId,"next",(parseInt(lastPage)+1));element=$("#"+pageId).children("li.active")}break;case"...":return}}else{if(pageCount>6){if(pageText<=3||pageText>=(pageCount-3)){newPages(pageId,"jump",pageText)}}}currentPage=activePage(pageId,element);if(currentPage!=""&&currentPage!=lastPage){$("#javaex-pager-"+pageId).val(currentPage);if(!!perPageCount){perPageCount=$("#javaex-perPageCount-"+pageId).val()}settings.callback({"pageNum":currentPage,"perPageCount":perPageCount})}})}function activePage(pageId,element){element.addClass("active").siblings().removeClass("active");return $("#"+pageId).children("li.active").text()}function newPages(pageId,type,i){var htmlLeft="";var htmlRight="";var htmlC="";var HL='<li><a>...</a></li>';var html='<li><a>上一页</a></li>';for(var n=0;n<3;n++){htmlC+='<li '+((n-1)==0?'class="active"':'')+' page="'+(i+n-1)+'"><a>'+(i+n-1)+'</a></li>';htmlLeft+='<li '+((n+2)==i?'class="active"':'')+' page="'+(n+2)+'"><a>'+(n+2)+'</a></li>';htmlRight+='<li '+((pageCount+n-3)==i?'class="active"':'')+' page="'+(pageCount+n-3)+'"><a>'+(pageCount+n-3)+'</a></li>'}switch(type){case"next":if(i<=4){html+='<li page="1"><a>1</a></li>'+htmlLeft+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else if(i>=(pageCount-3)){html+='<li page="1"><a>1</a></li>'+HL+htmlRight+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else{html+='<li page="1"><a>1</a></li>'+HL+htmlC+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}break;case"prev":if(i<=4){html+='<li page="1"><a>1</a></li>'+htmlLeft+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else if(i>=(pageCount-3)){html+='<li page="1"><a>1</a></li>'+HL+htmlRight+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else{html+='<li page="1"><a>1</a></li>'+HL+htmlC+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}break;case"jump":if(i<=4){if(i==1){html+='<li class="active" page="1"><a>1</a></li>'+htmlLeft+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else{html+='<li page="1"><a>1</a></li>'+htmlLeft+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}}else if((i>=pageCount-3)&&(pageCount>=7)){if(i==pageCount){html+='<li page="1"><a>1</a></li>'+HL+htmlRight+'<li class="active" page="'+pageCount+'"><a>'+pageCount+'</a></li>'}else{html+='<li page="1"><a>1</a></li>'+HL+htmlRight+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}}else{html+='<li page="1"><a>1</a></li>'+HL+htmlC+HL+'<li page="'+pageCount+'"><a>'+pageCount+'</a></li>'}}html+='<li><a>下一页</a></li>';if(pageCount>5||pageCount<3){var perPageCountHtml='';if(!!perPageCount){perPageCountHtml+='<span class="hint"><select id="javaex-perPageCount-'+pageId+'" class="select">';for(var i=1;i<10;i++){if(i*10==perPageCount){perPageCountHtml+='<option value="'+i+'0" selected>'+i+'0 条/页</option>'}else{perPageCountHtml+='<option value="'+i+'0">'+i+'0 条/页</option>'}}perPageCountHtml+='</select></span>'}$("#"+pageId).empty();$("#"+pageId).append(perPageCountHtml);$("#"+pageId).append(html);var number='';if(!!totalNum||isShowJumpPage){number+='<span class="hint">当前位置：';if(isShowJumpPage){number+='<input id="javaex-pager-'+pageId+'" class="input-pager" type="number" value="'+currentPage+'"><button id="javaex-button-mini-'+pageId+'" class="button-mini">跳页</button>'}if(totalNum!=null){number+='  共'+totalNum+'条'}number+='</span>'}$("#"+pageId).append(number);init(pageId)}}},loadDataFunction:"",isOver:"",flow:function(args){var settings=defaults(args);var pageId=settings.id;info.loadDataFunction=settings.loadDataFunction;var bottomH=50;init();function init(){var obj=document.getElementById("flow-loading-"+pageId);if(obj==null){$("#"+pageId).after('<div id="flow-loading-'+pageId+'" class="flow-loading" style="display: none;"></div>')}$(window).scroll(function(){var totalheight=parseFloat($(window).height())+parseFloat($(window).scrollTop()+bottomH);if(($(document).height()<=totalheight)&&(info.isOver!=pageId)){$(".flow-loading").show();info.loadDown(pageId)}else{$(".flow-loading").hide()}})}},over:function(pageId){info.isOver=pageId},loadDown:function(pageId){info.loadDataFunction()},slide:function(args){var settings=defaults(args);var id=settings.id;var slide=$("#"+id);var isAutoPlay=settings.isAutoPlay;var effect=settings.effect;var startSlide=parseInt(settings.startSlide);var index=startSlide-1;var $self=slide.find(".focus-bg li").eq(index).find("img");if($self.length==0){$self=slide.find(".focus-bg li").eq(index).find("a")}var original=$self.attr(settings.dataOriginal);if(!!original){if($self.is("img")){$self.attr("src",original)}else{$self.css("background-image","url('"+original+"')")}$self.removeAttr(settings.dataOriginal)}settings.callback({"index":index});var delay=parseInt(settings.delay);if(delay==200){delay=2000}var time=null;var slideBg=slide.find(".focus-bg");var slideLi=slideBg.find("li");var count=slideLi.length;switch(effect){case"slice":settings["width"]=slide.width();slideBg.css({"width":count*settings["width"]+"px"});slideLi.css({"float":"left","position":"relative"});slideLi.show();break}slide.find(".focus-bg li").each(function(i){if(effect=="slice"){if(i==index){var sliceWidth=index*slide.width();slide.find(".focus-bg").css({"margin-left":-sliceWidth+"px"})}}else if(effect=="smooth"){if(i==index){$(this).show()}else{$(this).hide()}}else{if(i==index){$(this).css("opacity",1);$(this).show()}else{$(this).css("opacity",0);$(this).hide()}}});if(slide.find(".focus-title").length>0){slide.find(".focus-title li").each(function(i){if(i==index){$(this).show()}else{$(this).hide()}})}if(slide.find(".focus-box").length>0){if(slide.find(".focus-box ul").length==0){var html='<ul>';for(var i=0;i<count;i++){html+='<li></li>'}html+='</ul>';slide.find(".focus-box").empty();slide.find(".focus-box").append(html)}slide.find(".focus-box li").eq(index).addClass("on")}autoPlay();slide.find(".slide-next").on("click",function(){var old=index;if(index>=(count-1)){index=0}else{index++}change.call(slide,index,old)});slide.find(".slide-prev").on("click",function(){var old=index;if(index<=0){index=count-1}else{index--}change.call(slide,index,old)});slide.find(".focus-box li").each(function(i){if(settings.focusBoxMode=="mouseover"){$(this).on("mouseover.slidebox",function(){change.call(slide,i,index);index=i})}else{$(this).on("click.slidebox",function(){change.call(slide,i,index);index=i})}});slide.on("mouseover",function(){if(isAutoPlay){clearInterval(time)}$(this).find(".slide-prev-next>div").css({"opacity":1,"visibility":"visible"})});slide.on("mouseleave",function(){if(isAutoPlay){autoPlay()}$(this).find(".slide-prev-next>div").css({"opacity":0,"visibility":"hidden"})});function autoPlay(){if(isAutoPlay){time=setInterval(function(){var old=index;if(index>=(count-1)){index=0}else{index++}change.call(slide,index,old)},delay)}}if(settings.focusCenter){var box=slide.find(".focus-box");box.css("margin-left",-(box.width()/2)+"px")}function change(show,hide){if(effect=="slice"){var sliceWidth=show*settings["width"];slide.find(".focus-bg").stop().animate({"margin-left":-sliceWidth+"px"})}else if(effect=="smooth"){slide.find(".focus-bg li").eq(hide).css({"display":"none"});slide.find(".focus-bg li").eq(show).css({"display":"list-item"})}else{slide.find(".focus-bg li").eq(hide).css({"opacity":0,"display":"none"});slide.find(".focus-bg li").eq(show).css({"display":"list-item"}).stop().animate({"opacity":1})}slide.find(".focus-title li").eq(hide).hide();slide.find(".focus-title li").eq(show).show();slide.find(".focus-box li").removeClass("on");slide.find(".focus-box li").eq(show).addClass("on");var $self=slide.find(".focus-bg li").eq(show).find("img");if($self.length==0){$self=slide.find(".focus-bg li").eq(show).find("a")}var original=$self.attr(settings.dataOriginal);if(!!original){if($self.is("img")){$self.attr("src",original)}else{$self.css("background-image","url('"+original+"')")}$self.removeAttr(settings.dataOriginal)}settings.callback({"index":show})}},date:function(args){var settings=defaults(args);var dateId=settings.id;var type=settings.type;if(type==""){type="yyyy-MM-dd"}var isTime=false;if(type!="yyyy-MM-dd"){isTime=true}var isClear=false;var initDate="";var initHMS="";var initStart="";var initEnd="";var hideMidDate=0;var monthNum=Math.min(parseInt(settings.monthNum),2);if(monthNum==1&&isTime){if(!settings.date.split(" ")[1]){settings.date=settings.date+" 00:00:00"}}var dateHtml='<div id="date-box-'+dateId+'" class="date-main date-ui" style="display: none;">';dateHtml+='<div class="date-body date-ui" id="date-list-'+dateId+'">';dateHtml+='</div>';dateHtml+='<div class="date-foot date-ui">';dateHtml+='<div class="form-msg" style="display:none;">';dateHtml+='<input type="text" id="hide-start-'+dateId+'" value="'+settings.startDate+'" readonly />';dateHtml+='<span> - </span>';dateHtml+='<input type="text" id="hide-end-'+dateId+'" value="'+settings.endDate+'" readonly />';dateHtml+='<input type="text" id="hide-date-'+dateId+'" value="'+settings.date.split(" ")[0]+'" readonly />';if(monthNum==1&&isTime){dateHtml+='<input type="text" id="hide-HMS-'+dateId+'" value="'+settings.date.split(" ")[1]+'" readonly />'}dateHtml+='</div>';dateHtml+='<div class="form-btn">';dateHtml+='<button class="button gray btn-left" id="date-clear-'+dateId+'">清空</button>';dateHtml+='<button class="button wathet btn-left" id="date-cancel-'+dateId+'">取消</button>';dateHtml+='<button class="button blue btn-right" id="date-ok-'+dateId+'">确定</button>';dateHtml+='</div>';dateHtml+='</div>';dateHtml+='</div>';$(document.body).append(dateHtml);init();close(true);$("#"+dateId).bind("click",function(){if(monthNum==1){initDate=document.getElementById("hide-date-"+dateId).value;if(isTime){initHMS=document.getElementById("hide-HMS-"+dateId).value}}else{initStart=document.getElementById("hide-start-"+dateId).value;initEnd=document.getElementById("hide-end-"+dateId).value;if(initStart!=""&&initEnd!=""){var hideStartDate=str2date(initStart).getTime();var hideEndDate=str2date(initEnd).getTime();hideMidDate=hideStartDate+(hideEndDate-hideStartDate)/2}}init();show();return});$("#date-ok-"+dateId).bind("click",function(){close(true);if(monthNum==1&&isTime){var str="";var date=$("#hide-date-"+dateId).val();if(date==""){str=""}else{str=date+" "+getHMStime()}settings.callback({"date":str})}else{settings.callback({"startDate":$("#hide-start-"+dateId).val(),"endDate":$("#hide-end-"+dateId).val(),"date":$("#hide-date-"+dateId).val()})}return});$("#date-cancel-"+dateId).bind("click",function(){if(monthNum==1){document.getElementById("hide-date-"+dateId).value=initDate;if(isTime){document.getElementById("hide-HMS-"+dateId).value=initHMS}}else{document.getElementById("hide-start-"+dateId).value=initStart;document.getElementById("hide-end-"+dateId).value=initEnd}close();isClear=false;return});$("#date-clear-"+dateId).bind("click",function(){var date=document.getElementById("hide-date-"+dateId).value;var start=document.getElementById("hide-start-"+dateId).value;var end=document.getElementById("hide-end-"+dateId).value;if(monthNum==1){document.getElementById("hide-date-"+dateId).value="";if(isTime){document.getElementById("hide-HMS-"+dateId).value="";$("#date-hour-"+dateId+" li").removeClass("current");$("#date-minute-"+dateId+" li").removeClass("current");$("#date-second-"+dateId+" li").removeClass("current")}}else{document.getElementById("hide-start-"+dateId).value="";document.getElementById("hide-end-"+dateId).value=""}removeCSS();isClear=true;return});function init(){var exDate=this;$("#date-list-"+dateId).empty();var endDate="";if(settings.endDate==""){if(settings.date==""){endDate=new Date()}else{endDate=str2date(settings.date.split(" ")[0])}}else{endDate=str2date(settings.endDate)}this.calendarEndDate=new Date(endDate.getFullYear(),endDate.getMonth()+1,0);if(monthNum==1&&isTime){for(var i=0;i<monthNum;i++){var td="";td=fillDate(endDate.getFullYear(),endDate.getMonth(),i);if(0==i){$("#date-list-"+dateId).append(td)}else{var firstTd=$("#date-list-"+dateId).find("table").get(0);$(firstTd).before(td)}endDate.setMonth(endDate.getMonth()-1,1)}var timeHtml='';timeHtml+='<table>';timeHtml+='<caption>时间选择</caption>';timeHtml+='<thead>';timeHtml+='<tr>';timeHtml+='<th>小时</th>';timeHtml+='<th>分钟</th>';timeHtml+='<th>秒数</th>';timeHtml+='</tr>';timeHtml+='</thead>';timeHtml+='<tbody>';timeHtml+='<tr>';var hourHtml='';hourHtml+='<td style="padding: 0;">';hourHtml+='<ul id="date-hour-'+dateId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<24;n++){if(n<10){hourHtml+='<li>0'+n+'</li>'}else{hourHtml+='<li>'+n+'</li>'}}hourHtml+='</ul>';hourHtml+='</td>';timeHtml+=hourHtml;var minuteHtml='';minuteHtml+='<td style="padding: 0;">';minuteHtml+='<ul id="date-minute-'+dateId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<60;n++){if(n<10){minuteHtml+='<li>0'+n+'</li>'}else{minuteHtml+='<li>'+n+'</li>'}}minuteHtml+='</ul>';minuteHtml+='</td>';timeHtml+=minuteHtml;var secondHtml='';secondHtml+='<td style="padding: 0;">';secondHtml+='<ul id="date-second-'+dateId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<60;n++){if(n<10){secondHtml+='<li>0'+n+'</li>'}else{secondHtml+='<li>'+n+'</li>'}}secondHtml+='</ul>';secondHtml+='</td>';timeHtml+=secondHtml;timeHtml+='</tr>';timeHtml+='</tbody>';timeHtml+='</table>';$("#date-list-"+dateId).append(timeHtml)}else{for(var i=0;i<monthNum;i++){var td="";td=fillDate(endDate.getFullYear(),endDate.getMonth(),i);if(0==i){$("#date-list-"+dateId).append(td)}else{var firstTd=$("#date-list-"+dateId).find("table").get(0);$(firstTd).before(td)}endDate.setMonth(endDate.getMonth()-1,1)}}this.calendarStartDate=new Date(endDate.getFullYear(),endDate.getMonth()+1,1);$("#last-year-"+dateId).bind("click",function(){exDate.calendarEndDate.setFullYear(exDate.calendarEndDate.getFullYear()-1,exDate.calendarEndDate.getMonth(),1);settings.endDate=date2ymd(exDate.calendarEndDate).join("-");init();return});$("#last-month-"+dateId).bind("click",function(){exDate.calendarEndDate.setMonth(exDate.calendarEndDate.getMonth()-1,1);settings.endDate=date2ymd(exDate.calendarEndDate).join("-");init();return});$("#next-month-"+dateId).bind("click",function(){exDate.calendarEndDate.setMonth(exDate.calendarEndDate.getMonth()+1,1);settings.endDate=date2ymd(exDate.calendarEndDate).join("-");init();return});$("#next-year-"+dateId).bind("click",function(){exDate.calendarEndDate.setFullYear(exDate.calendarEndDate.getFullYear()+1,exDate.calendarEndDate.getMonth(),1);settings.endDate=date2ymd(exDate.calendarEndDate).join("-");init();return});$("#date-hour-"+dateId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});$("#date-minute-"+dateId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});$("#date-second-"+dateId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});addCSS()}function setHMStime(){var hour=$("#date-hour-"+dateId+" li.current").text();var minute=$("#date-minute-"+dateId+" li.current").text();var second=$("#date-second-"+dateId+" li.current").text();$("#hide-HMS-"+dateId).val(hour+":"+minute+":"+second)}function removeCSS(){var csd=this.calendarStartDate;var ced=this.calendarEndDate;var bDate=new Date(csd.getFullYear(),csd.getMonth(),csd.getDate());var choice="";for(var d=new Date(bDate);d.getTime()<=ced.getTime();d.setDate(d.getDate()+1)){choice="choice-style";$("#"+dateId+"_date_"+date2ymd(d).join("-")).removeClass(choice);$("#"+dateId+"_date_"+date2ymd(d).join("-")).removeClass("started").removeClass("ended").removeClass("selected")}}function addCSS(){if(monthNum==1){var date=str2date($("#hide-date-"+dateId).val());$("#"+dateId+"_date_"+date2ymd(new Date(date)).join("-")).removeClass().addClass("ended");if(isTime){var HMS=$("#hide-HMS-"+dateId).val();var arr=HMS.split(":");$("#date-hour-"+dateId+" li").each(function(){if($(this).text()==arr[0]){$(this).addClass("current").siblings().removeClass("current");return}});$("#date-minute-"+dateId+" li").each(function(){if($(this).text()==arr[1]){$(this).addClass("current").siblings().removeClass("current");return}});$("#date-second-"+dateId+" li").each(function(){if($(this).text()==arr[2]){$(this).addClass("current").siblings().removeClass("current");return}})}return}var startDate=str2date($("#hide-start-"+dateId).val());var endDate=str2date($("#hide-end-"+dateId).val());var choice="";for(var d=new Date(startDate);d.getTime()<=endDate.getTime();d.setDate(d.getDate()+1)){choice="choice-style";$("#"+dateId+"_date_"+date2ymd(d).join("-")).removeClass("started").removeClass("ended").removeClass("selected");$("#"+dateId+"_date_"+date2ymd(d).join("-")).removeClass(choice);$("#"+dateId+"_date_"+date2ymd(d).join("-")).attr("class",choice)}$("#"+dateId+"_date_"+date2ymd(new Date(startDate)).join("-")).removeClass().addClass("started");$("#"+dateId+"_date_"+date2ymd(new Date(endDate)).join("-")).removeClass().addClass("ended")}function selectDate(ymd){isClear=false;var ymdFormat=formatDate(ymd);if(this.dateInput==("hide-date-"+dateId)){removeCSS();$("#"+dateId+"_date_"+ymd).attr("class","selected");$("#"+this.dateInput).val(ymdFormat);return}if($("#"+this.dateInput).val()==""){if(this.dateInput==("hide-start-"+dateId)){removeCSS();$("#"+dateId+"_date_"+ymd).attr("class","selected");$("#"+this.dateInput).val(ymdFormat);this.dateInput="hide-end-"+dateId}else if(this.dateInput==("hide-end-"+dateId)){if($("#hide-start-"+dateId).val()==""){this.dateInput="hide-start-"+dateId;selectDate(ymd);return}$("#"+this.dateInput).val(ymdFormat);this.dateInput="hide-start-"+dateId;var hideStartDate=str2date($("#hide-start-"+dateId).val()).getTime();var hideEndDate=str2date($("#hide-end-"+dateId).val()).getTime();if(hideEndDate<hideStartDate){var tmp=$("#hide-start-"+dateId).val();$("#hide-start-"+dateId).val($("#hide-end-"+dateId).val());$("#hide-end-"+dateId).val(tmp)}removeCSS();addCSS()}}else{var nowClickDate=str2date(ymdFormat).getTime();if(nowClickDate<hideMidDate){$("#hide-start-"+dateId).val(ymdFormat)}else{$("#hide-end-"+dateId).val(ymdFormat)}removeCSS();addCSS();var hideStartDate=str2date($("#hide-start-"+dateId).val()).getTime();var hideEndDate=str2date($("#hide-end-"+dateId).val()).getTime();hideMidDate=hideStartDate+(hideEndDate-hideStartDate)/2}}function show(){var pos=$("#"+dateId).offset();var left=pos.left;if(settings.alignment=="right"){var width=$("#"+dateId).width();left=left+width-($("#date-box-"+dateId).width()+20)}$("#date-box-"+dateId).css("display","block");$("#date-box-"+dateId).css("left",left+"px");$("#date-box-"+dateId).css("top",pos.top+$("#"+dateId).height()+4+"px");if(monthNum==1){this.dateInput="hide-date-"+dateId;if(isTime){var diffH=$("#date-hour-"+dateId+" li.current").position().top;if(diffH>220){diffH=diffH-83+"px";$("#date-hour-"+dateId).animate({"scrollTop":diffH},500)}var diffM=$("#date-minute-"+dateId+" li.current").position().top;if(diffM>220){diffM=diffM-83+"px";$("#date-minute-"+dateId).animate({"scrollTop":diffM},500)}var diffS=$("#date-second-"+dateId+" li.current").position().top;if(diffS>220){diffS=diffS-83+"px";$("#date-second-"+dateId).animate({"scrollTop":diffS},500)}}}else{this.dateInput="hide-start-"+dateId}}function close(isOk){if(isOk){var str="";if(isClear){if(monthNum==1){document.getElementById("hide-date-"+dateId).value="";if(isTime){document.getElementById("hide-HMS-"+dateId).value="";$("#date-hour-"+dateId+" li").removeClass("current");$("#date-minute-"+dateId+" li").removeClass("current");$("#date-second-"+dateId+" li").removeClass("current")}}else{document.getElementById("hide-start-"+dateId).value="";document.getElementById("hide-end-"+dateId).value=""}}else{if(monthNum==1){if(isTime){$("#"+dateId).val($("#hide-date-"+dateId).val()+" "+getHMStime())}else{$("#"+dateId).val($("#hide-date-"+dateId).val())}}else{if($("#hide-end-"+dateId).val()==""){$("#"+dateId).val($("#hide-start-"+dateId).val())}else{$("#"+dateId).val($("#hide-start-"+dateId).val()+settings.splitLine+$("#hide-end-"+dateId).val())}}if(monthNum==1){var date=$("#hide-date-"+dateId).val();if(isTime){if(date==""){str=""}else{str=date+" "+getHMStime()}}else{str=date}}else{if($("#hide-end-"+dateId).val()==""){$("#hide-end-"+dateId).val($("#hide-start-"+dateId).val())}str=$("#hide-start-"+dateId).val()+settings.splitLine+$("#hide-end-"+dateId).val();if(str==settings.splitLine){str=""}}}var obj=document.getElementById(dateId);if(obj&&obj.tagName=="INPUT"){$("#"+dateId).val(str)}else{$("#"+dateId).html(str)}isClear=false}$("#date-box-"+dateId).css("display","none")}function fillDate(year,month,index){var exDate=this;var firstDayOfMonth=new Date(year,month,1);var dateBegin=new Date(year,month,1);var w=dateBegin.getDay();dateBegin.setDate(1-w);var lastDayOfMonth=new Date(year,month+1,0);var dateEnd=new Date(year,month+1,0);w=dateEnd.getDay();dateEnd.setDate(dateEnd.getDate()+6-w);var today=new Date();var table=document.createElement("table");if(monthNum==1&&isTime){$(table).css("position","relative")}cap=document.createElement("caption");$(cap).append(year+"年"+(month+1)+"月");$(table).append(cap);thead=document.createElement("thead");tr=document.createElement("tr");var days=["日","一","二","三","四","五","六"];for(var i=0;i<7;i++){th=document.createElement("th");$(th).append(days[i]);$(tr).append(th)}$(thead).append(tr);$(table).append(thead);tr=document.createElement("tr");td=document.createElement("td");if(index==0){if(monthNum==1&&isTime){$(td).append('<a href="javascript:;" id="next-month-'+dateId+'"><span class="icon-chevron-right" style="position: absolute;top: 10px;right: 22px;color: #555;font-size: 14px;"></span></a>');$(td).append('<a href="javascript:;" id="next-year-'+dateId+'"><span class="icon-step-forward" style="position: absolute;top: 8px;right: 2px;color: #555;font-size: 16px;"></span></a>')}else{$(td).append('<a href="javascript:;" id="next-month-'+dateId+'"><span class="icon-chevron-right" style="position: absolute;top: 10px;right: 30px;color: #555;font-size: 14px;"></span></a>');$(td).append('<a href="javascript:;" id="next-year-'+dateId+'"><span class="icon-step-forward" style="position: absolute;top: 8px;right: 12px;color: #555;font-size: 16px;"></span></a>')}}if((index+1)==monthNum){if(monthNum==1&&isTime){$(td).append('<a href="javascript:;" id="last-year-'+dateId+'"><span class="icon-step-backward" style="position: absolute;top: 8px;left: 2px;color: #555;font-size: 16px;"></span></a>');$(td).append('<a href="javascript:;" id="last-month-'+dateId+'"><span class="icon-chevron-left" style="position: absolute;top: 10px;left: 22px;color: #555;font-size: 14px;"></span></a>')}else{$(td).append('<a href="javascript:;" id="last-year-'+dateId+'"><span class="icon-step-backward" style="position: absolute;top: 8px;left: 12px;color: #555;font-size: 16px;"></span></a>');$(td).append('<a href="javascript:;" id="last-month-'+dateId+'"><span class="icon-chevron-left" style="position: absolute;top: 10px;left: 30px;color: #555;font-size: 14px;"></span></a>')}}$(td).attr("colSpan",7);$(td).css("text-align","center");$(tr).append(td);var tbody=document.createElement("tbody");$(tbody).append(tr);var tdClass="";var deviation=0;var ymd="";var minTime="";if(settings.minTime=="today"){minTime=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate())}else{minTime=str2date(settings.minTime)}var maxTime="";if(settings.maxTime=="today"){maxTime=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate())}else{maxTime=str2date(settings.maxTime)}for(var d=dateBegin;d.getTime()<=dateEnd.getTime();d.setDate(d.getDate()+1)){if(d.getTime()<firstDayOfMonth.getTime()){tdClass="dateRangeGray";deviation=-1}else if(settings.minTime!=""&&d.getTime()<minTime.getTime()){tdClass="dateRangeGray";deviation=-2}else if(d.getTime()>lastDayOfMonth.getTime()){tdClass="dateRangeGray";deviation=1}else if(settings.maxTime!=""&&d.getTime()>maxTime.getTime()){tdClass="dateRangeGray";deviation=2}else{deviation=0;tdClass=""}if(d.getDay()==0){tr=document.createElement("tr")}td=document.createElement("td");td.innerHTML=d.getDate();if(tdClass!=""){$(td).attr("class",tdClass)}if(deviation==0){ymd=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();$(td).attr("id",dateId+"_date_"+ymd);(function(ymd){$(td).bind("click",ymd,function(){selectDate(ymd);return})})(ymd)}$(td).addClass("riqi");$(tr).append(td);if(d.getDay()==6){$(tbody).append(tr)}}$(table).append(tbody);return table}function str2date(str){var arr=str.split("-");return new Date(arr[0],arr[1]-1,arr[2])}function date2ymd(date){return[date.getFullYear(),(date.getMonth()+1),date.getDate()]}function formatDate(ymd){return ymd.replace(/(\d{4})\-(\d{1,2})\-(\d{1,2})/g,function(ymdFormatDate,y,m,d){if(m<10){m="0"+m}if(d<10){d="0"+d}return y+"-"+m+"-"+d})}function getHMStime(){var hour="";var minute="";var second="";if($("#date-hour-"+dateId+" li.current").length>0){hour=$("#date-hour-"+dateId+" li.current").text()}if($("#date-minute-"+dateId+" li.current").length>0){minute=$("#date-minute-"+dateId+" li.current").text()}if($("#date-second-"+dateId+" li.current").length>0){second=$("#date-second-"+dateId+" li.current").text()}var time="";if(hour!=""&&minute!=""&&second!=""){time=hour+":"+minute+":"+second}return time}},time:function(args){var settings=defaults(args);var timeId=settings.id;var time=settings.time;var initHMS="";var isClear=false;var timeHtml='<div id="date-box-'+timeId+'" class="date-main date-ui" style="display: none;">';timeHtml+='<div class="date-body date-ui" id="date-list-'+timeId+'">';timeHtml+='<table class="tableTime" style="width:90%;">';timeHtml+='<caption>时间选择</caption>';timeHtml+='<thead>';timeHtml+='<tr>';timeHtml+='<th style="text-align: center;">小时</th>';timeHtml+='<th style="text-align: center;">分钟</th>';timeHtml+='<th style="text-align: center;">秒数</th>';timeHtml+='</tr>';timeHtml+='</thead>';timeHtml+='<tbody>';timeHtml+='<tr>';var hourHtml='';hourHtml+='<td style="padding: 0;">';hourHtml+='<ul id="date-hour-'+timeId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<24;n++){if(n<10){hourHtml+='<li>0'+n+'</li>'}else{hourHtml+='<li>'+n+'</li>'}}hourHtml+='</ul>';hourHtml+='</td>';timeHtml+=hourHtml;var minuteHtml='';minuteHtml+='<td style="padding: 0;">';minuteHtml+='<ul id="date-minute-'+timeId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<60;n++){if(n<10){minuteHtml+='<li>0'+n+'</li>'}else{minuteHtml+='<li>'+n+'</li>'}}minuteHtml+='</ul>';minuteHtml+='</td>';timeHtml+=minuteHtml;var secondHtml='';secondHtml+='<td style="padding: 0;">';secondHtml+='<ul id="date-second-'+timeId+'" style="height: 180px; overflow: auto;">';for(var n=0;n<60;n++){if(n<10){secondHtml+='<li>0'+n+'</li>'}else{secondHtml+='<li>'+n+'</li>'}}secondHtml+='</ul>';secondHtml+='</td>';timeHtml+=secondHtml;timeHtml+='</tr>';timeHtml+='</tbody>';timeHtml+='</table>';timeHtml+='</div>';timeHtml+='<div class="date-foot date-ui" style="padding: 0;border-top: none;">';timeHtml+='<div class="form-msg" style="display:none;">';timeHtml+='<input type="text" id="hide-HMS-'+timeId+'" value="'+time+'" readonly />';timeHtml+='</div>';timeHtml+='<div class="form-btn">';timeHtml+='<button class="button gray btn-left" id="date-clear-'+timeId+'">清空</button>';timeHtml+='<button class="button wathet btn-left" id="date-cancel-'+timeId+'">取消</button>';timeHtml+='<button class="button blue btn-right" id="date-ok-'+timeId+'">确定</button>';timeHtml+='</div>';timeHtml+='</div>';timeHtml+='</div>';$(document.body).append(timeHtml);addCSS();show();close(true);$("#"+timeId).bind("click",function(){initHMS=document.getElementById("hide-HMS-"+timeId).value;addCSS();show();return});$("#date-ok-"+timeId).bind("click",function(){close(true);settings.callback({"time":getHMStime()});return});$("#date-cancel-"+timeId).bind("click",function(){document.getElementById("hide-HMS-"+timeId).value=initHMS;close();isClear=false;return});$("#date-clear-"+timeId).bind("click",function(){document.getElementById("hide-HMS-"+timeId).value="";$("#date-hour-"+timeId+" li").removeClass("current");$("#date-minute-"+timeId+" li").removeClass("current");$("#date-second-"+timeId+" li").removeClass("current");isClear=true;return});$("#date-hour-"+timeId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});$("#date-minute-"+timeId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});$("#date-second-"+timeId+" li").bind("click",function(){$(this).addClass("current").siblings().removeClass("current");setHMStime();return});function addCSS(){var HMS=$("#hide-HMS-"+timeId).val();var arr=HMS.split(":");$("#date-hour-"+timeId+" li").each(function(){if($(this).text()==arr[0]){$(this).addClass("current").siblings().removeClass("current");return}});$("#date-minute-"+timeId+" li").each(function(){if($(this).text()==arr[1]){$(this).addClass("current").siblings().removeClass("current");return}});$("#date-second-"+timeId+" li").each(function(){if($(this).text()==arr[2]){$(this).addClass("current").siblings().removeClass("current");return}})}function getHMStime(){var hour="";var minute="";var second="";if($("#date-hour-"+timeId+" li.current").length>0){hour=$("#date-hour-"+timeId+" li.current").text()}if($("#date-minute-"+timeId+" li.current").length>0){minute=$("#date-minute-"+timeId+" li.current").text()}if($("#date-second-"+timeId+" li.current").length>0){second=$("#date-second-"+timeId+" li.current").text()}var time="";if(hour!=""&&minute!=""&&second!=""){time=hour+":"+minute+":"+second}return time}function setHMStime(){var hour=$("#date-hour-"+timeId+" li.current").text();var minute=$("#date-minute-"+timeId+" li.current").text();var second=$("#date-second-"+timeId+" li.current").text();$("#hide-HMS-"+timeId).val(hour+":"+minute+":"+second)}function show(){var pos=$("#"+timeId).offset();var left=pos.left;$("#date-box-"+timeId).css("display","block");$("#date-box-"+timeId).css("left",left+"px");$("#date-box-"+timeId).css("top",pos.top+$("#"+timeId).height()+4+"px");if($("#date-hour-"+timeId+" li.current").length>0){var diffH=$("#date-hour-"+timeId+" li.current").position().top;if(diffH>220){diffH=diffH-83+"px";$("#date-hour-"+timeId).animate({"scrollTop":diffH},500)}}if($("#date-minute-"+timeId+" li.current").length>0){var diffM=$("#date-minute-"+timeId+" li.current").position().top;if(diffM>220){diffM=diffM-83+"px";$("#date-minute-"+timeId).animate({"scrollTop":diffM},500)}}if($("#date-second-"+timeId+" li.current").length>0){var diffS=$("#date-second-"+timeId+" li.current").position().top;if(diffS>220){diffS=diffS-83+"px";$("#date-second-"+timeId).animate({"scrollTop":diffS},500)}}}function close(isOk){if(isOk){var str="";if(isClear){document.getElementById("hide-HMS-"+timeId).value="";$("#date-hour-"+timeId+" li").removeClass("current");$("#date-minute-"+timeId+" li").removeClass("current");$("#date-second-"+timeId+" li").removeClass("current")}else{$("#"+timeId).val(getHMStime());str=getHMStime()}var obj=document.getElementById(timeId);if(obj&&obj.tagName=="INPUT"){$("#"+timeId).val(str)}else{$("#"+timeId).html(str)}isClear=false}$("#date-box-"+timeId).css("display","none")}},dragging:$(),placeholders:$(),upload:function(args){var settings=defaults(args);var type=settings.type;var url=settings.url;var inputId=settings.id;var isShowOptTip=settings.isShowOptTip;var containerId=settings.containerId;var uploadText=settings.uploadText;var addImg=settings.addImg;var maxNum=parseInt(settings.maxNum);var maxSize=parseInt(settings.maxSize);var param=settings.param;var imgUrl=settings.imgUrl;var dataType=settings.dataType;if(type=="editImage"){$("#"+inputId).change(function(){var imageFile=$("#"+inputId)[0].files[0];if(!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(imageFile.name)){info.optTip({content:"图片类型必须是.gif,jpeg,jpg,png中的一种",type:"error"});return false}if(maxSize==""||maxSize==0||maxSize=="0"){}else{if(imageFile.size>(maxSize*1024)){info.optTip({content:"图片过大，单张图片上限 "+maxSize+"KB",type:"error"});return false}}if(dataType=="base64"){var reader=new FileReader();if(imageFile){reader.onload=function(event){var base64Img=event.target.result;settings.callback(base64Img)}}reader.readAsDataURL(imageFile)}else if(dataType=="url"){var data=new FormData();data.append(param,imageFile);if(isShowOptTip){info.optTip({content:"文件上传中，请稍候...",type:"submit",timeout:0})}$.ajax({url:url,type:"post",data:data,dataType:"json",cache:false,contentType:false,processData:false,success:function(rtn){clearInterval(info.timeoutId);$(".ex-opt-tip").remove();$(".mask").remove();settings.callback(rtn)},error:function(){info.optTip({content:"上传失败，请稍后重试",type:"error"})}})}$("#"+inputId).val("")})}else if(type=="image"){var imageSrc=$("#"+containerId+" .cover").find("img").attr("src");if(!imageSrc){$("#"+containerId+" .cover img").attr("src",addImg);$("#"+containerId+" .cover img").after('<div class="cover-text">'+uploadText+'</div>')}else{$("#"+containerId+" .cover img").addClass("upload-img").removeClass("upload-img-cover")}$("#"+inputId).change(function(){var imageFile=$("#"+inputId)[0].files[0];if(!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(imageFile.name)){info.optTip({content:"图片类型必须是.gif,jpeg,jpg,png中的一种",type:"error"});return false}if(maxSize==""||maxSize==0){}else{if(imageFile.size>(maxSize*1024)){info.optTip({content:"图片过大，单张图片上限 "+maxSize+"KB",type:"error"});return false}}if(dataType=="base64"){var reader=new FileReader();if(imageFile){reader.onload=function(event){var base64Img=event.target.result;$("#"+containerId+" .cover img").addClass("upload-img").removeClass("upload-img-cover");$("#"+containerId+" .cover-text").remove();settings.callback(base64Img)}}reader.readAsDataURL(imageFile)}else if(dataType=="url"){var data=new FormData();data.append(param,imageFile);if(isShowOptTip){info.optTip({content:"图片上传中，请稍候...",type:"submit",timeout:0})}$.ajax({url:url,type:"post",data:data,dataType:"json",cache:false,contentType:false,processData:false,success:function(rtn){clearInterval(info.timeoutId);$(".ex-opt-tip").remove();$(".mask").remove();$("#"+containerId+" .cover img").addClass("upload-img").removeClass("upload-img-cover");$("#"+containerId+" .cover-text").remove();settings.callback(rtn)},error:function(){info.optTip({content:"上传失败，请稍后重试",type:"error"})}})}$("#"+inputId).val("")})}else if(type=="images"){if(!!imgUrl){var uuidArr=new Array();for(var i=0;i<imgUrl.length;i++){var UUID=info.getUUID();uuidArr.push(UUID);var imgHtml='<li id='+UUID+' class="upload-images-thumbnail" style="width:'+settings.width+'px;height:'+settings.height+'px;">';imgHtml+='<div class="img-trash"><span class="icon-trash-o"></span></div>';imgHtml+='<img src="'+imgUrl[i]+'" />';imgHtml+='</li>';$("#"+containerId).append(imgHtml)}imgBindEvent(uuidArr);var imgUrlArr=new Array();$("#"+containerId+" img").each(function(){imgUrlArr.push($(this).attr("src"))});settings.callback(imgUrlArr)}$("#"+inputId).change(function(){if($("#"+containerId+" img").length>(parseInt(maxNum)-1)){info.optTip({content:"最多上传"+maxNum+"张图片",type:"error"});return false}if(dataType=="base64"){var uuidArr=new Array();var count=0;var fileLength=$("#"+inputId)[0].files.length;var nowNum=$("#"+containerId+" img").length;$.each($("#"+inputId)[0].files,function(i){if((nowNum+i)<maxNum){var UUID=info.getUUID();uuidArr.push(UUID);var imageFile=$("#"+inputId)[0].files[i];if(!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(imageFile.name)){info.optTip({content:"图片类型必须是.gif,jpeg,jpg,png中的一种",type:"error"});return false}if(maxSize==""||maxSize==0){}else{if(imageFile.size>(maxSize*1024)){info.optTip({content:"图片过大，单张图片上限 "+maxSize+"KB",type:"error"});return false}}var reader=new FileReader();reader.onload=function(event){var base64Img=event.target.result;var imgHtml='<li id='+UUID+' class="upload-images-thumbnail" style="width:'+settings.width+'px;height:'+settings.height+'px;">';imgHtml+='<div class="img-trash"><span class="icon-trash-o"></span></div>';imgHtml+='<img src="'+base64Img+'" />';imgHtml+='</li>';$("#"+containerId).append(imgHtml);imgBindEvent(UUID);count++;if((count==fileLength)||(nowNum+i)==(parseInt(maxNum)-1)){var imgUrlArr=new Array();$("#"+containerId+" img").each(function(){imgUrlArr.push($(this).attr("src"))});settings.callback(imgUrlArr);imgSort(containerId)}};reader.readAsDataURL(imageFile)}})}else if(dataType=="url"){var image=settings.image;var uuidArr=new Array();var count=0;var fileLength=$("#"+inputId)[0].files.length;var nowNum=$("#"+containerId+" img").length;for(var i=0;i<fileLength;i++){if((nowNum+i)<maxNum){var UUID=info.getUUID();uuidArr.push(UUID);var imgHtml='<li id='+UUID+' class="upload-images-thumbnail" style="width:'+settings.width+'px;height:'+settings.height+'px;">';imgHtml+='<div class="img-trash"><span class="icon-trash-o"></span></div>';imgHtml+='<img src="'+settings.placeholder+'" />';imgHtml+='</li>';$("#"+containerId).append(imgHtml)}}$.each($("#"+inputId)[0].files,function(i){if((nowNum+i)<maxNum){var UUID=uuidArr[i];var imageFile=$("#"+inputId)[0].files[i];if(!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(imageFile.name)){info.optTip({content:"图片类型必须是.gif,jpeg,jpg,png中的一种",type:"error"});return false}if(maxSize==""||maxSize==0){}else{if(imageFile.size>(maxSize*1024)){info.optTip({content:"图片过大，单张图片上限 "+maxSize+"KB",type:"error"});return false}}var data=new FormData();data.append(param,imageFile);$.ajax({url:image.url,type:"post",data:data,dataType:"json",cache:false,contentType:false,processData:false,success:function(rtn){image.rtnData=rtn;var imgSrc="";if(!image.prefix){if(image.imgUrl.split(".").length==2){imgSrc=image.rtnData[image.imgUrl.split(".")[0]][image.imgUrl.split(".")[1]]}else{imgSrc=image.rtnData[image.imgUrl]}}else{if(image.imgUrl.split(".").length==2){imgSrc=image.prefix+image.rtnData[image.imgUrl.split(".")[0]][image.imgUrl.split(".")[1]]}else{imgSrc=image.prefix+image.rtnData[image.imgUrl]}}$("#"+UUID).find("img").attr("src",imgSrc);imgBindEvent(UUID);count++;if((count==fileLength)||(nowNum+i)==(maxNum-1)){var imgUrlArr=new Array();$("#"+containerId+" img").each(function(){imgUrlArr.push($(this).attr("src"))});settings.callback(imgUrlArr);imgSort(containerId)}},error:function(){info.optTip({content:"上传失败，请稍后重试",type:"error"})}})}})}$("#"+inputId).val("")});function imgBindEvent(UUID){$("#"+UUID).on("mouseenter",{index:i},function(event){var i=event.data.index;$("#"+UUID+" .img-trash").stop().animate({height:"30px"})});$("#"+UUID).on("mouseleave",{index:i},function(event){var i=event.data.index;$("#"+UUID+" .img-trash").stop().animate({height:0})});$("#"+UUID+" .img-trash span").on("click",{index:i},function(event){var i=event.data.index;$("#"+UUID).remove();var imgUrlArr=new Array();$("#"+containerId+" img").each(function(){imgUrlArr.push($(this).attr("src"))});settings.callback(imgUrlArr)})}function imgSort(containerId){options=$.extend({},null);return $("#"+containerId).each(function(){var isHandle,index,items=$(this).children(options.items);var placeholder=$('<'+(/^ul|ol$/i.test(this.tagName)?'li':'div')+' class="javaex-sort-placeholder">');items.find(options.handle).mousedown(function(){isHandle=true}).mouseup(function(){isHandle=false});$(this).data('items',options.items);info.placeholders=info.placeholders.add(placeholder);items.attr('draggable','true').on('dragstart.h5s',function(e){if(options.handle&&!isHandle){return false}isHandle=false;var dt=e.originalEvent.dataTransfer;dt.effectAllowed='move';dt.setData('Text','dummy');index=(info.dragging=$(this)).addClass('javaex-sort-dragging').index()}).on('dragend.h5s',function(){(info.dragging=$(this)).removeClass('javaex-sort-dragging').show();info.placeholders.detach();if(index!=(info.dragging=$(this)).index()){items.parent().trigger('sortupdate',{item:info.dragging});var imgUrlArr=new Array();$("#"+containerId+" img").each(function(){imgUrlArr.push($(this).attr("src"))});settings.callback(imgUrlArr)}info.dragging=null}).not('a[href], img').on('selectstart.h5s',function(){this.dragDrop&&this.dragDrop();return false}).end().add([this,placeholder]).on('dragover.h5s dragenter.h5s drop.h5s',function(e){if(!items.is(info.dragging)&&options.connectWith!==$(info.dragging).parent().data('connectWith')){return true}if(e.type=='drop'){e.stopPropagation();info.placeholders.filter(':visible').after(info.dragging);return false}e.preventDefault();e.originalEvent.dataTransfer.dropEffect='move';if(items.is(this)){if(options.forcePlaceholderSize){placeholder.height(info.dragging.outerHeight())}info.dragging.hide();$(this)[placeholder.index()<$(this).index()?'after':'before'](placeholder);info.placeholders.not(placeholder).detach()}else if(!info.placeholders.is(this)&&!$(this).children(options.items).length){info.placeholders.detach();$(this).append(placeholder)}return false})})}}else if(type=="file"){$("#"+inputId).change(function(){var imageFile=$("#"+inputId)[0].files[0];if(maxSize==""||maxSize==0||maxSize=="0"){}else{if(imageFile.size>(maxSize*1024*1024)){info.optTip({content:"文件过大，单个文件上限 "+maxSize+"M",type:"error"});return false}}var data=new FormData();data.append(param,imageFile);if(isShowOptTip){info.optTip({content:"文件上传中，请稍候...",type:"submit",timeout:0})}$.ajax({url:url,type:"post",data:data,dataType:"json",cache:false,contentType:false,processData:false,success:function(rtn){clearInterval(info.timeoutId);$(".ex-opt-tip").remove();$(".mask").remove();settings.callback(rtn)},error:function(){info.optTip({content:"上传失败，请稍后重试",type:"error"})}})})}},ratio:1,dragAble:false,mouseX:0,mouseY:0,imgDivId:"",cutBox:"",moveBox:"",dataUrl:"",imgSrc:"",image:new Image(),uploadAvatar:function(obj,args){var settings=defaults(args);info.imgDivId=settings.imgDivId;info.moveBox=settings.moveBox;info.cutBox=settings.cutBox;info.dataUrl=settings.dataUrl;var reader=new FileReader();var imageFile=obj.files[0];if(imageFile){reader.onload=function(event){info.imgSrc=event.target.result;info.image.src=info.imgSrc;info.image.onload=function(){$("#"+settings.moveBox).hide();info.setBackgroundImage();info.headPreview();$("#"+info.imgDivId).bind("mousewheel DOMMouseScroll",info.imageZoom);$("#"+info.imgDivId).bind("mousedown",info.mouseDown);$("#"+info.imgDivId).bind("mousemove",info.imageDrag);$(window).bind("mouseup",info.mouseUp);$("#narrow").on("click",function(){info.narrow()});$("#enlarge").on("click",function(){info.enlarge()})}}}reader.readAsDataURL(imageFile)},enlarge:function(){this.ratio=this.ratio*1.1;info.setBackgroundImage()},narrow:function(){this.ratio=this.ratio*0.9;info.setBackgroundImage()},setBackgroundImage:function(){var zoomImgWidth=parseInt(info.image.width)*info.ratio;var zoomImgHeight=parseInt(info.image.height)*info.ratio;var posX=($("#"+info.imgDivId).width()-zoomImgWidth)/2;var posY=($("#"+info.imgDivId).height()-zoomImgHeight)/2;$("#"+info.imgDivId).css({"background-image":"url("+info.image.src+")","background-repeat":"no-repeat","background-size":zoomImgWidth+"px "+zoomImgHeight+"px","background-position":posX+"px "+posY+"px"})},imageZoom:function(event){if(event.originalEvent.wheelDelta>0||event.originalEvent.detail<0){info.ratio=info.ratio*1.1}else{info.ratio=info.ratio*0.9}info.setBackgroundImage();info.headPreview();event.preventDefault()},mouseDown:function(event){event.stopImmediatePropagation();info.dragAble=true;info.mouseX=event.clientX;info.mouseY=event.clientY},imageDrag:function(event){event.stopImmediatePropagation();if(info.dragAble){var diffX=event.clientX-info.mouseX;var diffY=event.clientY-info.mouseY;var arr=$("#"+info.imgDivId).css("background-position").split(" ");var posX=diffX+parseInt(arr[0]);var posY=diffY+parseInt(arr[1]);$("#"+info.imgDivId).css("background-position",posX+"px "+posY+"px");info.mouseX=event.clientX;info.mouseY=event.clientY}},mouseUp:function(event){event.stopImmediatePropagation();info.dragAble=false;info.headPreview()},headPreview:function(){var cutBoxWidth=$("#"+info.cutBox).width();var cutBoxHeight=$("#"+info.cutBox).height();var canvas=document.createElement("canvas");var posArr=$("#"+info.imgDivId).css("background-position").split(" ");var sizeArr=$("#"+info.imgDivId).css("background-size").split(" ");var swidth=parseInt(info.image.width);var sheight=parseInt(info.image.height);var x=parseInt(posArr[0])-$("#"+info.imgDivId).width()/2+cutBoxWidth/2;var y=parseInt(posArr[1])-$("#"+info.imgDivId).height()/2+cutBoxHeight/2;var width=parseInt(sizeArr[0]);var height=parseInt(sizeArr[1]);canvas.width=cutBoxWidth;canvas.height=cutBoxHeight;var context=canvas.getContext("2d");context.drawImage(info.image,0,0,swidth,sheight,x,y,width,height);var avatarPreviewImageSrc=canvas.toDataURL('image/png');$(".avatar180").html('');$(".avatar50").html('');$(".avatar30").html('');$(".avatar180").append('<img src="'+avatarPreviewImageSrc+'" align="absmiddle" style="width:180px;border-radius:180px;">');$(".avatar50").append('<img src="'+avatarPreviewImageSrc+'" align="absmiddle" style="width:50px;border-radius:50px;">');$(".avatar30").append('<img src="'+avatarPreviewImageSrc+'" align="absmiddle" style="width:30px;border-radius:30px;">');$("#"+info.dataUrl).val(avatarPreviewImageSrc)},curRange:"",edit:function(args){var settings=defaults(args);var editId=settings.id;var content=$("#"+editId).html();$("#"+editId).empty();var fixedTop=parseInt(settings.fixedTop);var UUID=info.getUUID();var editHtml='';editHtml+='<div class="edit-toolbar">';editHtml+='<div class="edit-btn-toolbar clear">';editHtml+='<div class="javaex-edit-family edit-btn edit-btn-name-fontsize edit-combobox">';editHtml+='<span tip="字体" class="edit-button-label"><i>arial</i><span class="icon-caret-down"></span></span>';editHtml+='<ul class="javaex-edit-family-select dropdown-menu edit-combobox-menu edit-combobox-paragraph" style="z-index: 2;display:none;">';editHtml+='<li class="edit-combobox-item edit-combobox-checked"><label class="edit-combobox-item-label">arial</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">宋体</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">微软雅黑</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">楷体</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">黑体</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">隶书</label></li>';editHtml+='<li class="edit-combobox-item"><label class="edit-combobox-item-label">Consolas</label></li>';editHtml+='</ul>';editHtml+='</div>';editHtml+='<div class="javaex-edit-size edit-btn edit-btn-name-fontsize edit-combobox">';editHtml+='<span tip="字号" class="edit-button-label"><i>16</i><span class="icon-caret-down"></span></span>';editHtml+='<ul class="javaex-edit-size-select dropdown-menu edit-combobox-menu edit-combobox-paragraph" style="z-index: 2;display:none;">';editHtml+='<li class="edit-combobox-item edit-combobox-item-7"><label class="edit-combobox-item-label">12</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-6"><label class="edit-combobox-item-label">14</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-5 edit-combobox-checked"><label class="edit-combobox-item-label">16</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-4"><label class="edit-combobox-item-label">18</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-3"><label class="edit-combobox-item-label">24</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-2"><label class="edit-combobox-item-label">32</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-1"><label class="edit-combobox-item-label">48</label></li>';editHtml+='</ul>';editHtml+='</div>';editHtml+='<div class="javaex-edit-format edit-btn edit-btn-name-fontsize edit-combobox">';editHtml+='<span tip="段落格式" class="edit-button-label"><i>p</i><span class="icon-caret-down"></span></span>';editHtml+='<ul class="javaex-edit-format-select dropdown-menu edit-combobox-menu edit-combobox-paragraph" style="z-index: 2;display:none;">';editHtml+='<li class="edit-combobox-item edit-combobox-item-7 edit-combobox-checked"><label class="edit-combobox-item-label">p</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-6"><label class="edit-combobox-item-label">H6</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-5"><label class="edit-combobox-item-label">H5</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-4"><label class="edit-combobox-item-label">H4</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-3"><label class="edit-combobox-item-label">H3</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-2"><label class="edit-combobox-item-label">H2</label></li>';editHtml+='<li class="edit-combobox-item edit-combobox-item-1"><label class="edit-combobox-item-label">H1</label></li>';editHtml+='</ul>';editHtml+='</div>';editHtml+='<span class="separator-line"></span>';editHtml+='<a class="edit-btn" tip="本地图片"><div class="icon icon-photo"><label for="'+UUID+'" style="display: inline-block; width:100%;height:100%;position: absolute;top: 0;left: 0;"></label></div>';editHtml+='<input type="file" style="display:none;" id="'+UUID+'" accept="image/gif, image/jpeg, image/jpg, image/png" /></a>';editHtml+='<a class="edit-btn edit-btn-music" tip="外链音乐"><div class="icon icon-audiotrack"></div></a>';editHtml+='<a class="edit-btn edit-btn-video" tip="外链视频"><div class="icon icon-video"></div></a>';editHtml+='<a class="edit-btn edit-btn-href" tip="超链接"><div class="icon icon-chain"></div></a>';editHtml+='<a class="edit-btn edit-btn-unlink" tip="去除超链接"><div class="icon icon-chain-broken"></div></a>';editHtml+='<span class="separator-line"></span>';editHtml+='<a class="edit-btn edit-btn-bold" tip="加粗"><div class="icon icon-format_bold"></div></a>';editHtml+='<a class="edit-btn edit-btn-italic" tip="斜体"><div class="icon icon-format_italic"></div></a>';editHtml+='<a class="edit-btn edit-btn-underline" tip="下划线"><div class="icon icon-format_underlined"></div></a>';editHtml+='<a class="edit-btn edit-btn-strikethrough" tip="删除线"><div class="icon icon-strikethrough_s"></div></a>';editHtml+='<span class="edit-btn-foreColor"><a class="edit-btn" tip="字体颜色"><div class="icon icon-format_color_text"></div></a></span>';editHtml+='<span class="edit-btn-backColor"><a class="edit-btn" tip="背景颜色"><div class="icon icon-font_download"></div></a></span>';editHtml+='<span class="separator-line"></span>';editHtml+='<a class="edit-btn edit-btn-superscript" tip="上标"><div class="icon icon-superscript"></div></a>';editHtml+='<a class="edit-btn edit-btn-subscript" tip="下标"><div class="icon icon-subscript"></div></a>';editHtml+='<a class="edit-btn edit-btn-insertHorizontalRule" tip="分隔线"><div class="icon icon-line"></div></a>';editHtml+='<a class="edit-btn edit-btn-selectAll" tip="全选"><div class="icon icon-select_all"></div></a>';editHtml+='<a class="edit-btn edit-btn-removeFormat" tip="清除格式"><div class="icon icon-format_clear"></div></a>';editHtml+='<span class="separator-line"></span>';editHtml+='<a class="edit-btn edit-btn-indent" tip="增加缩进"><div class="icon icon-format_indent_increase"></div></a>';editHtml+='<a class="edit-btn edit-btn-outdent" tip="减少缩进"><div class="icon icon-format_indent_decrease"></div></a>';editHtml+='<a class="edit-btn edit-btn-justifyleft" tip="居左对齐"><div class="icon icon-format_align_left"></div></a>';editHtml+='<a class="edit-btn edit-btn-justifycenter" tip="居中对齐"><div class="icon icon-format_align_center"></div></a>';editHtml+='<a class="edit-btn edit-btn-justifyright" tip="居右对齐"><div class="icon icon-format_align_right"></div></a>';editHtml+='<span class="separator-line"></span>';editHtml+='<a class="edit-btn edit-btn-insertOrderedList" tip="有序列表"><div class="icon icon-format_list_numbered"></div></a>';editHtml+='<a class="edit-btn edit-btn-insertUnorderedList" tip="无序列表"><div class="icon icon-format_list_bulleted"></div></a>';editHtml+='<a class="edit-btn edit-btn-table" tip="表格"><div class="icon icon-table"></div></a>';editHtml+='<a class="edit-btn edit-btn-quote" tip="添加引用文字"><div class="icon icon-format_quote"></div></a>';editHtml+='<a class="edit-btn edit-btn-code" tip="添加代码"><div class="icon icon-code"></div></a>';editHtml+='</div>';editHtml+='</div>';editHtml+='<div class="edit-editor-body">';editHtml+='<div class="edit-body-container" contenteditable="true">';if(content==""){editHtml+='<p><br /></p>'}else{editHtml+=content}editHtml+='</div>';editHtml+='</div>';$("#"+editId).append(editHtml);if(settings.isInit){callback()}if(fixedTop>=0){var toolbarWidth=$("#"+editId+" .edit-toolbar").width();$(window).scroll(function(){var distanceFromTop=$("#"+editId).offset().top-document.documentElement.scrollTop;if(distanceFromTop<fixedTop){$("#"+editId+" .edit-toolbar").css({"position":"fixed","top":fixedTop+"px","width":toolbarWidth+"px","z-index":"900"})}else{$("#"+editId+" .edit-toolbar").css({"position":"relative","top":"unset","width":"auto","z-index":"900"})}})}$("#"+editId+" .edit-body-container").bind("mouseup keyup",function(){saveCurRange();callback()});var image=settings.image;if(image==null||image.dataType=="base64"){info.upload({type:"editImage",id:UUID,dataType:"base64",callback:function(rtn){restoreSelection();execCommand("insertimage",false,rtn)}})}else{var isShowOptTip=image.isShowOptTip;if(!isShowOptTip){isShowOptTip=false}info.upload({type:"editImage",url:image.url,id:UUID,param:image.param,dataType:"url",isShowOptTip:isShowOptTip,callback:function(rtn){$(".ex-opt-tip").remove();$(".mask").remove();restoreSelection();image.rtnData=rtn;if(!image.prefix){if(image.imgUrl.split(".").length==2){execCommand("insertimage",false,image.rtnData[image.imgUrl.split(".")[0]][image.imgUrl.split(".")[1]])}else{execCommand("insertimage",false,image.rtnData[image.imgUrl])}}else{if(image.imgUrl.split(".").length==2){execCommand("insertimage",false,image.prefix+image.rtnData[image.imgUrl.split(".")[0]][image.imgUrl.split(".")[1]])}else{execCommand("insertimage",false,image.prefix+image.rtnData[image.imgUrl])}}}})}var isBold=false;$("#"+editId+" .edit-btn-bold").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("bold",false,null);if(isBold){isBold=false;$(this).removeClass("edit-active")}else{isBold=true;$(this).addClass("edit-active")}return false});var isItalic=false;$("#"+editId+" .edit-btn-italic").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("italic",false,null);if(isItalic){isItalic=false;$(this).removeClass("edit-active")}else{isItalic=true;$(this).addClass("edit-active")}return false});$("#"+editId+" .edit-btn-indent").bind("click",function(){execCommand("indent",false,null);return false});$("#"+editId+" .edit-btn-outdent").bind("click",function(){execCommand("outdent",false,null);return false});$("#"+editId+" .edit-btn-justifyleft").bind("click",function(){execCommand("justifyLeft",false,null);return false});$("#"+editId+" .edit-btn-justifycenter").bind("click",function(){execCommand("justifyCenter",false,null);return false});$("#"+editId+" .edit-btn-justifyright").bind("click",function(){execCommand("justifyRight",false,null);return false});$("#"+editId+" .edit-btn-music").bind("click",function(){var html='<div style="margin:-20px;">';html+='<div class="unit clear">';html+='<div class="left"><p class="subtitle">链接地址</p></div>';html+='<div class="right" style="width: auto;"><input type="text" class="text" style="width: 380px;" id="javaex-edit-music-href" autocomplete="off"/></div>';html+='</div>';html+='<div class="unit clear">';html+='<div class="left"><p class="subtitle">播放器宽高</p></div>';html+='<div class="right">';html+='<input type="text" class="text" id="javaex-edit-music-width" value="330" style="width: auto;" placeholder="宽" />';html+='<input type="text" class="text" id="javaex-edit-music-height" value="86" style="margin-left: 30px;width: auto;" placeholder="高" />';html+='</div>';html+='</div>';html+='</div>';info.alert({content:html,title:"外链音乐",width:"500px",callback:"javaex.musicCallback()"});return false});$("#"+editId+" .edit-btn-video").bind("click",function(){var html='<div style="margin:-20px;">';html+='<div class="unit clear">';html+='<div class="left"><p class="subtitle">链接地址</p></div>';html+='<div class="right" style="width: auto;"><input type="text" class="text" style="width: 380px;" id="javaex-edit-video-href" placeholder="支持优酷、bilibili" autocomplete="off"/></div>';html+='</div>';html+='<div class="unit clear">';html+='<div class="left"><p class="subtitle">播放器宽高</p></div>';html+='<div class="right">';html+='<input type="text" class="text" id="javaex-edit-video-width" value="640" style="width: auto;" placeholder="宽" />';html+='<input type="text" class="text" id="javaex-edit-video-height" value="400" style="margin-left: 30px;width: auto;" placeholder="高" />';html+='</div>';html+='</div>';html+='</div>';info.alert({content:html,title:"外链视频",width:"500px",callback:"javaex.videoCallback()"});return false});$("#"+editId+" .edit-btn-href").bind("click",function(){var html='<div style="margin:-20px;">';html+='<div class="unit clear">';html+='	<div class="left"><p class="subtitle">链接地址</p></div>';html+='	<div class="right" style="width: auto;"><input type="text" class="text" style="width: 380px;" id="javaex-edit-href" autocomplete="off"/></div>';html+='</div>';html+='<div class="unit clear">';html+='	<div class="left"><p class="subtitle">标题</p></div>';html+='	<div class="right" style="width: auto;"><input type="text" class="text" style="width: 380px;" id="javaex-edit-hrefText" autocomplete="off"/></div>';html+='</div>';html+='<div class="unit clear">';html+='	<div class="left"><p class="subtitle">新标签</p></div>';html+='	<div class="right" style="width: auto;"><input type="checkbox" class="fill" name="javaex-href_blank" value="1" checked/>新标签打开</div>';html+='</div>';html+='</div>';info.alert({content:html,title:"超链接",width:"500px",callback:"javaex.hrefCallback()"});$(':checkbox[name="javaex-href_blank"]').each(function(){if($(this).hasClass("fill")){if($(this).parent()[0].tagName=="LABEL"){$(this).parent().addClass("fill-label");var text=$(this)[0].nextSibling.nodeValue;$(this)[0].nextSibling.nodeValue=""}else{var text=$(this)[0].nextSibling.nodeValue;$(this)[0].nextSibling.nodeValue="";$(this).wrap('<label class="fill-label"></label>')}if(!!text){text=text.replace(/(\s*$)/g,"");if(text.length==0){$(this).parent().append('<span></span>')}else{$(this).parent().append('<span class="fill-text">'+text+'</span>')}}if($(this).siblings().length==1){$(this).after('<span class="fill-css icon-check" style="color: #fff;"></span>')}}});return false});$("#"+editId+" .edit-btn-unlink").bind("click",function(){execCommand("unlink",false,null);return false});var isUnderline=false;$("#"+editId+" .edit-btn-underline").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("underline",false,null);if(isUnderline){isUnderline=false;$(this).removeClass("edit-active")}else{isUnderline=true;$(this).addClass("edit-active")}return false});var isStrikethrough=false;$("#"+editId+" .edit-btn-strikethrough").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("strikethrough",false,null);if(isStrikethrough){isStrikethrough=false;$(this).removeClass("edit-active")}else{isStrikethrough=true;$(this).addClass("edit-active")}return false});var isSuperscript=false;$("#"+editId+" .edit-btn-superscript").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("superscript",false,null);if(isSuperscript){isSuperscript=false;$(this).removeClass("edit-active")}else{isSuperscript=true;$(this).addClass("edit-active")}return false});var isSubscript=false;$("#"+editId+" .edit-btn-subscript").bind("click",function(){var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("subscript",false,null);if(isSubscript){isSubscript=false;$(this).removeClass("edit-active")}else{isSubscript=true;$(this).addClass("edit-active")}return false});var isInsertOrderedList=false;$("#"+editId+" .edit-btn-insertOrderedList").bind("click",function(){execCommand("insertOrderedList",false,null);if(isInsertOrderedList){isInsertOrderedList=false;$(this).removeClass("edit-active")}else{isInsertOrderedList=true;$("#"+editId+" .edit-btn-insertUnorderedList").removeClass("edit-active");$(this).addClass("edit-active")}return false});var isInsertUnorderedList=false;$("#"+editId+" .edit-btn-insertUnorderedList").bind("click",function(){execCommand("insertUnorderedList",false,null);if(isInsertUnorderedList){isInsertUnorderedList=false;$(this).removeClass("edit-active")}else{isInsertUnorderedList=true;$("#"+editId+" .edit-btn-insertOrderedList").removeClass("edit-active");$(this).addClass("edit-active")}return false});$("#"+editId+" .edit-btn-insertHorizontalRule").bind("click",function(){execCommand("insertHTML",false,'<hr /><br />');return false});$("#"+editId+" .edit-btn-selectAll").bind("click",function(){execCommand("selectAll",false,null);return false});$("#"+editId+" .edit-btn-removeFormat").bind("click",function(){execCommand("removeFormat",false,null);return false});var isForeColor=false;$("#"+editId+" .edit-btn-foreColor").bind("click",function(){$(this).addClass("edit-active");$("#"+editId+" .edit-btn-backColor .edit-color-menu").hide();if($("#"+editId+" .edit-btn-foreColor .edit-color-menu").length==0){$(this).append(editColorMenu())}else{if($("#"+editId+" .edit-btn-foreColor .edit-color-menu").is(':hidden')){$("#"+editId+" .edit-btn-foreColor .edit-color-menu").show()}}$("#"+editId+" .edit-btn-foreColor .edit-color-menu input").bind("click",function(e){$(this).parent().css("display","none");var color=$(this).attr("color-val");execCommand("foreColor",false,color);e.stopPropagation();if(color=="Black"){$("#"+editId+" .edit-btn-foreColor .icon-format_color_text").css("color","unset");$("#"+editId+" .edit-btn-foreColor").removeClass("edit-active")}else{$("#"+editId+" .edit-btn-foreColor .icon-format_color_text").css("color",color)}});return false});var isBackColor=false;$("#"+editId+" .edit-btn-backColor").bind("click",function(){$(this).addClass("edit-active");$("#"+editId+" .edit-btn-foreColor .edit-color-menu").hide();if($("#"+editId+" .edit-btn-backColor .edit-color-menu").length==0){$(this).append(editColorMenu())}else{if($("#"+editId+" .edit-btn-backColor .edit-color-menu").is(':hidden')){$("#"+editId+" .edit-btn-backColor .edit-color-menu").show()}}$("#"+editId+" .edit-btn-backColor .edit-color-menu input").bind("click",function(e){$(this).parent().css("display","none");var color=$(this).attr("color-val");execCommand("backColor",false,color);e.stopPropagation();if(color=="White"){$("#"+editId+" .edit-btn-backColor .icon-font_download").css("color","unset");$("#"+editId+" .edit-btn-backColor").removeClass("edit-active")}else{$("#"+editId+" .edit-btn-backColor .icon-font_download").css("color",color)}});return false});$("#"+editId+" .edit-btn-table").bind("click",function(){var html='表格行数：<input type="text" class="text" id="javaex-edit-table-row-num" style="width:60px;" value="2" autocomplete="off"/>';html+='   表格列数：<input type="text" class="text" id="javaex-edit-table-col-num" style="width:60px;" value="2" autocomplete="off"/>';info.alert({content:html,title:"添加表格",width:"360px",callback:"javaex.tableCallback()"});return false});$(document).click(function(){$("#"+editId+" .javaex-edit-family-select").hide();$("#"+editId+" .javaex-edit-size-select").hide();$("#"+editId+" .javaex-edit-format-select").hide();$("#"+editId+" .edit-color-menu").hide()});$("#"+editId+" .javaex-edit-family").bind("click",function(){restoreSelection();$("#"+editId+" .javaex-edit-size-select").hide();$("#"+editId+" .javaex-edit-format-select").hide();$("#"+editId+" .javaex-edit-family-select").show();event.stopPropagation()});$("#"+editId+" .javaex-edit-family-select > li").bind("click",function(){$(this).closest(".javaex-edit-family").find("i").text($(this).text());$(this).addClass("edit-combobox-checked").siblings().removeClass("edit-combobox-checked");$("#"+editId+" .javaex-edit-family-select").fadeOut();var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("fontName",false,$(this).text())});$("#"+editId+" .javaex-edit-size").bind("click",function(){restoreSelection();$("#"+editId+" .javaex-edit-family-select").hide();$("#"+editId+" .javaex-edit-format-select").hide();$("#"+editId+" .javaex-edit-size-select").show();event.stopPropagation()});$("#"+editId+" .javaex-edit-size-select > li").bind("click",function(){var fontSize=$(this).text();var fontSizeText="14px";switch(fontSize){case"48":fontSize=7;fontSizeText="48px";break;case"32":fontSize=6;fontSizeText="32px";break;case"24":fontSize=5;fontSizeText="24px";break;case"18":fontSize=4;fontSizeText="18px";break;case"16":fontSize=3;fontSizeText="16px";break;case"14":fontSize=2;fontSizeText="14px";break;case"12":fontSize=1;fontSizeText="12px";break;default:fontSize=3;fontSizeText="16px";break}$(this).closest(".javaex-edit-size").find("i").text($(this).text());$(this).addClass("edit-combobox-checked").siblings().removeClass("edit-combobox-checked");$("#"+editId+" .javaex-edit-size-select").fadeOut();var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("fontSize",false,fontSize)});$("#"+editId+" .javaex-edit-format").bind("click",function(){restoreSelection();$("#"+editId+" .javaex-edit-family-select").hide();$("#"+editId+" .javaex-edit-size-select").hide();$("#"+editId+" .javaex-edit-format-select").show();event.stopPropagation()});$("#"+editId+" .javaex-edit-format-select > li").bind("click",function(){$(this).closest(".javaex-edit-format").find("i").text($(this).text());$(this).addClass("edit-combobox-checked").siblings().removeClass("edit-combobox-checked");$("#"+editId+" .javaex-edit-format-select").fadeOut();var selection=restoreSelection();if(selection==null||selection.type!="Range"){info.curRange=null}execCommand("removeFormat",false,null);execCommand("formatBlock",false,$(this).text())});$("#"+editId+" .edit-btn-quote").bind("click",function(){info.alert({content:'<textarea id="javaex-edit-quote" wrap="hard" class="desc" style="height: 160px;"></textarea>',title:"请输入引用内容",width:"500px",callback:"javaex.quoteCallback()"});return false});$("#"+editId+" .edit-btn-code").bind("click",function(){restoreSelection();execCommand("insertHTML",false,'<pre><code><br /></code></pre><p><br />')});function editColorMenu(){return'<div class="edit-color-menu"><input type="button" style="background-color: Black" title="黑色" color-val="Black"><input type="button" style="background-color: Sienna" color-val="Sienna" title="赭色"><input type="button" style="background-color: DarkOliveGreen" color-val="DarkOliveGreen" title="暗橄榄绿色"><input type="button" style="background-color: DarkGreen" color-val="DarkGreen" title="暗绿色"><input type="button" style="background-color: DarkSlateBlue" color-val="DarkSlateBlue" title="暗灰蓝色"><input type="button" style="background-color: Navy" color-val="Navy" title="海军色"><input type="button" style="background-color: Indigo" color-val="Indigo" title="靛青色"><input type="button" style="background-color: DarkSlateGray" color-val="DarkSlateGray" title="墨绿色"><input type="button" style="background-color: DarkRed" color-val="DarkRed" title="暗红色"><input type="button" style="background-color: DarkOrange" color-val="DarkOrange" title="暗桔黄色"><input type="button" style="background-color: Olive" color-val="Olive" title="橄榄色"><input type="button" style="background-color: Green" color-val="Green" title="绿色"><input type="button" style="background-color: Teal" color-val="Teal" title="水鸭色"><input type="button" style="background-color: Blue" color-val="Blue" title="蓝色"><input type="button" style="background-color: SlateGray" color-val="SlateGray" title="灰石色"><input type="button" style="background-color: DimGray" color-val="DimGray" title="暗灰色"><input type="button" style="background-color: Red" color-val="Red" title="红色"><input type="button" style="background-color: SandyBrown" color-val="SandyBrown" title="沙褐色"><input type="button" style="background-color: YellowGreen" color-val="YellowGreen" title="黄绿色"><input type="button" style="background-color: SeaGreen" color-val="SeaGreen" title="海绿色"><input type="button" style="background-color: MediumTurquoise" color-val="MediumTurquoise" title="间绿宝石"><input type="button" style="background-color: RoyalBlue" color-val="RoyalBlue" title="皇家蓝"><input type="button" style="background-color: Purple" color-val="Purple" title="紫色"><input type="button" style="background-color: Gray" color-val="Gray" title="灰色"><input type="button" style="background-color: Magenta" color-val="Magenta" title="红紫色"><input type="button" style="background-color: Orange" color-val="Orange" title="橙色"><input type="button" style="background-color: Yellow" color-val="Yellow" title="黄色"><input type="button" style="background-color: Lime" color-val="Lime" title="酸橙色"><input type="button" style="background-color: Cyan" color-val="Cyan" title="青色"><input type="button" style="background-color: DeepSkyBlue" color-val="DeepSkyBlue" title="深天蓝色"><input type="button" style="background-color: DarkOrchid" color-val="DarkOrchid" title="暗紫色"><input type="button" style="background-color: Silver" color-val="Silver" title="银色"><input type="button" style="background-color: Pink" color-val="Pink" title="粉色"><input type="button" style="background-color: Wheat" color-val="Wheat" title="浅黄色"><input type="button" style="background-color: LemonChiffon" color-val="LemonChiffon" title="柠檬绸色"><input type="button" style="background-color: White" color-val="White" title="白色"></div>'}function getCurRange(){var selection=null;var range=null;var parentElement=null;var oEditArea=$("#"+editId+" .edit-body-container")[0];selection=window.document.getSelection();if(selection.getRangeAt&&selection.rangeCount){range=window.document.getSelection().getRangeAt(0);parentElement=range.commonAncestorContainer}if(parentElement&&(parentElement.id==oEditArea.id||window.jQuery.contains(oEditArea,parentElement))){return range}}function saveCurRange(){info.curRange=getCurRange()}function restoreSelection(){var selection=null;if(!!info.curRange){selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}return selection}function execCommand(command,mode,data){document.execCommand(command,mode,data);callback()}function callback(){settings.callback({"html":$("#"+editId+" .edit-body-container").html().replace(/<(script)[\S\s]*?\1>/gi,"").replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>"),"text":$("#"+editId+" .edit-body-container").text().replace(/<(script)[\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\<|\>|\&/g,"")})}},hrefCallback:function(){var href=$("#javaex-edit-href").val();var hrefText=$("#javaex-edit-hrefText").val();var _blank="0";if(!!href){if(!hrefText){hrefText=href}if($(':checkbox[name="javaex-href_blank"]').is(":checked")){_blank="1"}if(!!info.curRange){var selection=null;selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}var hrefHtml='<a href="'+href+'">'+hrefText+'</a>';if(_blank=="1"){hrefHtml='<a href="'+href+'" target="_blank">'+hrefText+'</a>'}document.execCommand('insertHTML',false,hrefHtml)}},quoteCallback:function(){var quote=$("#javaex-edit-quote").val();if(!quote){quote="<br/>"}if(!!info.curRange){var selection=null;selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}var quoteHtml='<div class="javaex-edit-quote"><blockquote>'+quote+'</blockquote></div><br/>';document.execCommand('insertHTML',false,quoteHtml)},tableCallback:function(){var rowNum=$("#javaex-edit-table-row-num").val();var colNum=$("#javaex-edit-table-col-num").val();var html='';html+='<table class="table unhover edit-table">';html+='	<tbody>';for(var row=0;row<rowNum;row++){html+='	<tr>';for(var col=0;col<colNum;col++){html+='	<td></td>'}html+='	</tr>'}html+='	</tbody>';html+='</table>';html+='<br/>';if(!!info.curRange){var selection=null;selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}document.execCommand('insertHTML',false,html)},musicCallback:function(){var href=$("#javaex-edit-music-href").val();var width=$("#javaex-edit-music-width").val();var height=$("#javaex-edit-music-height").val();if(!!href&&!!width&&!!height){if(href.indexOf("http")<0){href="http:"+href}var html='<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width='+width+' height='+height+' src="'+href+'"></iframe>';if(!!info.curRange){var selection=null;selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}document.execCommand('insertHTML',false,html)}},videoCallback:function(){var href=$("#javaex-edit-video-href").val();var width=$("#javaex-edit-video-width").val();var height=$("#javaex-edit-video-height").val();if(!!href&&!!width&&!!height){if(href.indexOf("bilibili")>=0){href=href.replace("?","\/");var substr=href.match(/av(\S*)\//);if(!!substr){substr=substr[1]}href="https://player.bilibili.com/player.html?aid="+substr}else if(href.indexOf("youku")>=0){var substr=href.match(/id_(\S*).html/);if(!!substr){substr=substr[1]}href="http://player.youku.com/embed/"+substr}var html='<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width='+width+' height='+height+' src="'+href+'"></iframe>';if(!!info.curRange){var selection=null;selection=window.document.getSelection();selection.removeAllRanges();selection.addRange(info.curRange)}document.execCommand('insertHTML',false,html)}}};return info};$.belowthefold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=(window.innerHeight?window.innerHeight:$(window).height())+$(window).scrollTop()}else{fold=$(settings.container).offset().top+$(settings.container).height()}return fold<=$(element).offset().top-settings.threshold};$.rightoffold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$(window).width()+$(window).scrollLeft()}else{fold=$(settings.container).offset().left+$(settings.container).width()}return fold<=$(element).offset().left-settings.threshold};$.abovethetop=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$(window).scrollTop()}else{fold=$(settings.container).offset().top}return fold>=$(element).offset().top+settings.threshold+$(element).height()};$.leftofbegin=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$(window).scrollLeft()}else{fold=$(settings.container).offset().left}return fold>=$(element).offset().left+settings.threshold+$(element).width()};window.javaex=javaex()})();
